!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()}((()=>"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:Function("return this")())(),function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./build/index.js")}({"./build/index.js":function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=t.io=t.Manager=t.protocol=void 0;var i=n("./build/url.js"),o=n("./build/manager.js"),s=n("./build/socket.js");Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return s.Socket}});var a=n("./node_modules/debug/src/browser.js")("socket.io-client");e.exports=t=c;var u=t.managers={};function c(e,t){"object"===r(e)&&(t=e,e=void 0),t=t||{};var n,s=i.url(e),c=s.source,l=s.id,h=s.path,d=u[l]&&h in u[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(a("ignoring socket cache for %s",c),n=new o.Manager(c,t)):(u[l]||(a("new io instance for %s",c),u[l]=new o.Manager(c,t)),n=u[l]),s.query&&!t.query&&(t.query=s.query),n.socket(s.path,t)}t.io=c;var l=n("./node_modules/socket.io-parser/dist/index.js");Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return l.protocol}}),t.connect=c;var h=n("./build/manager.js");Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return h.Manager}})},"./build/manager.js":function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;var c=n("./node_modules/engine.io-client/lib/index.js"),l=n("./build/socket.js"),h=n("./node_modules/component-emitter/index.js"),d=n("./node_modules/socket.io-parser/dist/index.js"),f=n("./build/on.js"),p=n("./node_modules/component-bind/index.js"),g=n("./node_modules/backo2/index.js"),m=n("./node_modules/debug/src/browser.js")("socket.io-client:manager"),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(b,h);var t,n,v,y=a(b);function b(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(n=y.call(this)).nsps={},n.subs=[],e&&"object"===r(e)&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",n.opts=t,n.reconnection(!1!==t.reconnection),n.reconnectionAttempts(t.reconnectionAttempts||1/0),n.reconnectionDelay(t.reconnectionDelay||1e3),n.reconnectionDelayMax(t.reconnectionDelayMax||5e3),n.randomizationFactor(t.randomizationFactor||.5),n.backoff=new g({min:n.reconnectionDelay(),max:n.reconnectionDelayMax(),jitter:n.randomizationFactor()}),n.timeout(null==t.timeout?2e4:t.timeout),n._readyState="closed",n.uri=e;var i=t.parser||d;return n.encoder=new i.Encoder,n.decoder=new i.Decoder,n._autoConnect=!1!==t.autoConnect,n._autoConnect&&n.open(),n}return t=b,(n=[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(m("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;m("opening %s",this.uri),this.engine=c(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var i=f.on(n,"open",function(){r.onopen(),e&&e()}),s=f.on(n,"error",function(n){m("error"),r.cleanup(),r._readyState="closed",o(u(b.prototype),"emit",t).call(t,"error",n),e?e(n):r.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;m("connect attempt will timeout after %d",a),0===a&&i.destroy();var l=setTimeout(function(){m("connect attempt timed out after %d",a),i.destroy(),n.close(),n.emit("error",new Error("timeout"))},a);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(i),this.subs.push(s),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){m("open"),this.cleanup(),this._readyState="open",o(u(b.prototype),"emit",this).call(this,"open");var e=this.engine;this.subs.push(f.on(e,"data",p(this,"ondata")),f.on(e,"ping",p(this,"onping")),f.on(e,"error",p(this,"onerror")),f.on(e,"close",p(this,"onclose")),f.on(this.decoder,"decoded",p(this,"ondecoded")))}},{key:"onping",value:function(){o(u(b.prototype),"emit",this).call(this,"ping")}},{key:"ondata",value:function(e){this.decoder.add(e)}},{key:"ondecoded",value:function(e){o(u(b.prototype),"emit",this).call(this,"packet",e)}},{key:"onerror",value:function(e){m("error",e),o(u(b.prototype),"emit",this).call(this,"error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n||(n=new l.Socket(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var r=n[t];if(this.nsps[r].active)return void m("socket %s is still active, skipping close",r)}this._close()}},{key:"_packet",value:function(e){m("writing packet %j",e),e.query&&0===e.type&&(e.nsp+="?"+e.query);for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){m("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.decoder.destroy()}},{key:"_close",value:function(){m("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e){m("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",o(u(b.prototype),"emit",this).call(this,"close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)m("reconnect failed"),this.backoff.reset(),o(u(b.prototype),"emit",this).call(this,"reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();m("will wait %dms before reconnect attempt",n),this._reconnecting=!0;var r=setTimeout(function(){t.skipReconnect||(m("attempting reconnect"),o(u(b.prototype),"emit",e).call(e,"reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(function(n){n?(m("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),o(u(b.prototype),"emit",e).call(e,"reconnect_error",n)):(m("reconnect success"),t.onreconnect())}))},n);this.subs.push({destroy:function(){clearTimeout(r)}})}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),o(u(b.prototype),"emit",this).call(this,"reconnect",e)}}])&&i(t.prototype,n),v&&i(t,v),b}();t.Manager=v},"./build/on.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0,t.on=function(e,t,n){return e.on(t,n),{destroy:function(){e.off(t,n)}}}},"./build/socket.js":function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;var h=n("./node_modules/socket.io-parser/dist/index.js"),d=n("./node_modules/component-emitter/index.js"),f=n("./build/on.js"),p=n("./node_modules/component-bind/index.js"),g=n("./node_modules/debug/src/browser.js")("socket.io-client:socket"),m=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(v,d);var t,n,r,o=c(v);function v(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(r=o.call(this)).ids=0,r.acks={},r.receiveBuffer=[],r.sendBuffer=[],r.flags={},r.io=e,r.nsp=t,r.ids=0,r.acks={},r.receiveBuffer=[],r.sendBuffer=[],r.connected=!1,r.disconnected=!0,r.flags={},n&&n.auth&&(r.auth=n.auth),r.io._autoConnect&&r.open(),r}return t=v,(n=[{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[f.on(e,"open",p(this,"onopen")),f.on(e,"packet",p(this,"onpacket")),f.on(e,"close",p(this,"onclose"))]}}},{key:"connect",value:function(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen(),this)}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(m.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.unshift(e);var i={type:h.PacketType.EVENT,data:n,options:{}};i.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]&&(g("emitting packet with ack id %d",this.ids),this.acks[this.ids]=n.pop(),i.id=this.ids++);var o=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!o||!this.connected)?g("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;g("transport is open - connecting"),"function"==typeof this.auth?this.auth(function(t){e.packet({type:h.PacketType.CONNECT,data:t})}):this.packet({type:h.PacketType.CONNECT,data:this.auth})}},{key:"onclose",value:function(e){g("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,a(l(v.prototype),"emit",this).call(this,"disconnect",e)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case h.PacketType.CONNECT:if(e.data&&e.data.sid){var t=e.data.sid;this.onconnect(t)}else a(l(v.prototype),"emit",this).call(this,"connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case h.PacketType.EVENT:case h.PacketType.BINARY_EVENT:this.onevent(e);break;case h.PacketType.ACK:case h.PacketType.BINARY_ACK:this.onack(e);break;case h.PacketType.DISCONNECT:this.ondisconnect();break;case h.PacketType.CONNECT_ERROR:var n=new Error(e.data.message);n.data=e.data.data,a(l(v.prototype),"emit",this).call(this,"connect_error",n)}}},{key:"onevent",value:function(e){var t=e.data||[];g("emitting event %j",t),null!=e.id&&(g("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,n=i(this._anyListeners.slice());try{for(n.s();!(t=n.n()).done;){t.value.apply(this,e)}}catch(e){n.e(e)}finally{n.f()}}a(l(v.prototype),"emit",this).apply(this,e)}},{key:"ack",value:function(e){var t=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];g("sending ack %j",i),t.packet({type:h.PacketType.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"==typeof t?(g("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):g("bad ack %s",e.id)}},{key:"onconnect",value:function(e){g("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,a(l(v.prototype),"emit",this).call(this,"connect"),this.emitBuffered()}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach(function(t){return e.emitEvent(t)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(t){return e.packet(t)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){g("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&(g("performing disconnect (%s)",this.nsp),this.packet({type:h.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"active",get:function(){return!!this.subs}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}}])&&s(t.prototype,n),r&&s(t,r),v}();t.Socket=v},"./build/url.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.url=void 0;var r=n("./node_modules/parseuri/index.js"),i=n("./node_modules/debug/src/browser.js")("socket.io-client:url");t.url=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},"./node_modules/backo2/index.js":function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},"./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,s,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var l=new ArrayBuffer(a),h=new Uint8Array(l);for(t=0;t<u;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],h[c++]=r<<2|i>>4,h[c++]=(15&i)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return l}}()},"./node_modules/component-bind/index.js":function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},"./node_modules/component-emitter/index.js":function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},"./node_modules/debug/src/browser.js":function(e,t,n){(function(r){function i(e){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(i=++r)}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n("./node_modules/debug/src/common.js")(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/debug/src/common.js":function(e,t,n){function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return i.colors[Math.abs(t)%i.colors.length]}function i(e){var n;function r(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(r.enabled){var s=r,a=Number(new Date),u=a-(n||a);s.diff=u,s.prev=n,s.curr=a,n=a,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;c++;var r=i.formatters[n];if("function"==typeof r){var o=t[c];e=r.call(s,o),t.splice(c,1),c--}return e}),i.formatArgs.call(s,t),(s.log||i.log).apply(s,t)}}return r.namespace=e,r.enabled=i.enabled(e),r.useColors=i.useColors(),r.color=t(e),r.destroy=o,r.extend=s,"function"==typeof i.init&&i.init(r),i.instances.push(r),r}function o(){var e=i.instances.indexOf(this);return-1!==e&&(i.instances.splice(e,1),!0)}function s(e,t){var n=i(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function a(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){return e instanceof Error?e.stack||e.message:e},i.disable=function(){var e=[].concat(r(i.names.map(a)),r(i.skips.map(a).map(function(e){return"-"+e}))).join(",");return i.enable(""),e},i.enable=function(e){var t;i.save(e),i.names=[],i.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")));for(t=0;t<i.instances.length;t++){var o=i.instances[t];o.enabled=i.enabled(o.namespace)}},i.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=i.skips.length;t<n;t++)if(i.skips[t].test(e))return!1;for(t=0,n=i.names.length;t<n;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=n("./node_modules/ms/index.js"),Object.keys(e).forEach(function(t){i[t]=e[t]}),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=t,i.enable(i.load()),i}},"./node_modules/engine.io-client/lib/globalThis.browser.js":function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},"./node_modules/engine.io-client/lib/index.js":function(e,t,n){var r=n("./node_modules/engine.io-client/lib/socket.js");e.exports=function(e,t){return new r(e,t)},e.exports.Socket=r,e.exports.protocol=r.protocol,e.exports.Transport=n("./node_modules/engine.io-client/lib/transport.js"),e.exports.transports=n("./node_modules/engine.io-client/lib/transports/index.js"),e.exports.parser=n("./node_modules/engine.io-parser/lib/index.js")},"./node_modules/engine.io-client/lib/socket.js":function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=n("./node_modules/engine.io-client/lib/transports/index.js"),l=n("./node_modules/component-emitter/index.js"),h=n("./node_modules/debug/src/browser.js")("engine.io-client:socket"),d=n("./node_modules/engine.io-parser/lib/index.js"),f=n("./node_modules/parseuri/index.js"),p=n("./node_modules/parseqs/index.js"),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(m,l);var t,n,u,g=a(m);function m(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),t=g.call(this),e&&"object"===i(e)&&(n=e,e=null),e?(e=f(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=f(n.host).host),t.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=t.secure?"443":"80"),t.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),t.port=n.port||("undefined"!=typeof location&&location.port?location.port:t.secure?443:80),t.transports=n.transports||["polling","websocket"],t.readyState="",t.writeBuffer=[],t.prevBufferLen=0,t.opts=r({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},n),t.opts.path=t.opts.path.replace(/\/$/,"")+"/","string"==typeof t.opts.query&&(t.opts.query=p.decode(t.opts.query)),t.id=null,t.upgrades=null,t.pingInterval=null,t.pingTimeout=null,t.pingTimeoutTimer=null,t.open(),t}return t=m,(n=[{key:"createTransport",value:function(e){h('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.opts.query);t.EIO=d.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=r({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return h("options: %j",n),new c[e](n)}},{key:"open",value:function(){var e;if(this.opts.rememberUpgrade&&m.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return h("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){h("setting transport %s",e.name);var t=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})}},{key:"probe",value:function(e){h('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(h('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(h('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;m.priorWebsocketSuccess="websocket"===t.name,h('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(h("changing transport and sending upgrade packet"),l(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{h('probe transport "%s" failed',e);var o=new Error("probe error");o.transport=t.name,r.emit("upgradeError",o)}}))}function o(){n||(n=!0,l(),t.close(),t=null)}function s(n){var i=new Error("probe error: "+n);i.transport=t.name,o(),h('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function a(){s("transport closed")}function u(){s("socket closed")}function c(e){t&&e.name!==t.name&&(h('"%s" works - aborting "%s"',e.name,t.name),o())}function l(){t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",a),r.removeListener("close",u),r.removeListener("upgrading",c)}m.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",s),t.once("close",a),this.once("close",u),this.once("upgrading",c),t.open()}},{key:"onOpen",value:function(){if(h("socket open"),this.readyState="open",m.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){h("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else h('packet received with socket readyState "%s"',this.readyState)}},{key:"onHandshake",value:function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(function(){e.onClose("ping timeout")},this.pingInterval+this.pingTimeout)}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var e=this;function t(){e.onClose("forced close"),h("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()),this}},{key:"onError",value:function(e){h("socket error %j",e),m.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){h('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}])&&o(t.prototype,n),u&&o(t,u),m}();g.priorWebsocketSuccess=!1,g.protocol=d.protocol,e.exports=g},"./node_modules/engine.io-client/lib/transport.js":function(e,t,n){function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=n("./node_modules/engine.io-parser/lib/index.js"),c=n("./node_modules/component-emitter/index.js"),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(l,c);var t,n,r,a=s(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this)).opts=e,t.query=e.query,t.readyState="",t.socket=e.socket,t}return t=l,(n=[{key:"onError",value:function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,this.emit("open")}},{key:"onData",value:function(e){var t=u.decodePacket(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){this.emit("packet",e)}},{key:"onClose",value:function(){this.readyState="closed",this.emit("close")}}])&&i(t.prototype,n),r&&i(t,r),l}();e.exports=l},"./node_modules/engine.io-client/lib/transports/index.js":function(e,t,n){var r=n("./node_modules/engine.io-client/lib/xmlhttprequest.js"),i=n("./node_modules/engine.io-client/lib/transports/polling-xhr.js"),o=n("./node_modules/engine.io-client/lib/transports/polling-jsonp.js"),s=n("./node_modules/engine.io-client/lib/transports/websocket.js");t.polling=function(e){var t=!1,n=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),t=e.hostname!==location.hostname||u!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!s)throw new Error("JSONP disabled");return new o(e)},t.websocket=s},"./node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(e,t,n){function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return u(e)}(this,n)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l,h=n("./node_modules/engine.io-client/lib/transports/polling.js"),d=n("./node_modules/engine.io-client/lib/globalThis.browser.js"),f=/\n/g,p=/\\n/g;function g(){}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(v,h);var t,n,r,m=a(v);function v(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=m.call(this,e)).query=t.query||{},l||(l=d.___eio=d.___eio||[]),t.index=l.length;var n=u(t);return l.push(function(e){n.onData(e)}),t.query.j=t.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=g)},!1),t}return t=v,(n=[{key:"doClose",value:function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o(c(v.prototype),"doClose",this).call(this)}},{key:"doPoll",value:function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)}},{key:"doWrite",value:function(e,t){var n,r=this;if(!this.form){var i=document.createElement("form"),o=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=s,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function a(){u(),t()}function u(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}this.form.action=this.uri(),u(),e=e.replace(p,"\\\n"),this.area.value=e.replace(f,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&a()}:this.iframe.onload=a}},{key:"supportsBinary",get:function(){return!1}}])&&i(t.prototype,n),r&&i(t,r),v}();e.exports=m},"./node_modules/engine.io-client/lib/transports/polling-xhr.js":function(e,t,n){function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=n("./node_modules/engine.io-client/lib/xmlhttprequest.js"),f=n("./node_modules/engine.io-client/lib/transports/polling.js"),p=n("./node_modules/component-emitter/index.js"),g=n("./node_modules/engine.io-client/lib/util.js").pick,m=n("./node_modules/engine.io-client/lib/globalThis.browser.js"),v=n("./node_modules/debug/src/browser.js")("engine.io-client:polling-xhr");function y(){}var b=null!=new d({xdomain:!1}).responseType,w=function(e){u(n,f);var t=l(n);function n(e){var r;if(o(this,n),r=t.call(this,e),"undefined"!=typeof location){var i="https:"===location.protocol,s=location.port;s||(s=i?443:80),r.xd="undefined"!=typeof location&&e.hostname!==location.hostname||s!==e.port,r.xs=e.secure!==i}var a=e&&e.forceBase64;return r.supportsBinary=b&&!a,r}return a(n,[{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(e,{xd:this.xd,xs:this.xs},this.opts),new k(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this.request({method:"POST",data:e}),r=this;n.on("success",t),n.on("error",function(e){r.onError("xhr post error",e)})}},{key:"doPoll",value:function(){v("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e}}]),n}(),k=function(e){u(n,p);var t=l(n);function n(e,r){var i;return o(this,n),(i=t.call(this)).opts=r,i.method=r.method||"GET",i.uri=e,i.async=!1!==r.async,i.data=void 0!==r.data?r.data:null,i.create(),i}return a(n,[{key:"create",value:function(){var e=g(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;var t=this.xhr=new d(e),r=this;try{v("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}catch(e){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout(function(){r.onError("number"==typeof t.status?t.status:0)},0))},v("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}"undefined"!=typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(e){this.emit("data",e),this.onSuccess()}},{key:"onError",value:function(e){this.emit("error",e),this.cleanup(!0)}},{key:"cleanup",value:function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=y:this.xhr.onreadystatechange=y,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete n.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&this.onData(e)}},{key:"hasXDR",value:function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}},{key:"abort",value:function(){this.cleanup()}}]),n}();if(k.requestsCount=0,k.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",_);else if("function"==typeof addEventListener){addEventListener("onpagehide"in m?"pagehide":"unload",_,!1)}function _(){for(var e in k.requests)k.requests.hasOwnProperty(e)&&k.requests[e].abort()}e.exports=w,e.exports.Request=k},"./node_modules/engine.io-client/lib/transports/polling.js":function(e,t,n){function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=n("./node_modules/engine.io-client/lib/transport.js"),c=n("./node_modules/parseqs/index.js"),l=n("./node_modules/engine.io-parser/lib/index.js"),h=n("./node_modules/yeast/index.js"),d=n("./node_modules/debug/src/browser.js")("engine.io-client:polling"),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(f,u);var t,n,r,a=s(f);function f(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a.apply(this,arguments)}return t=f,(n=[{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;function n(){d("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(d("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){d("pre-pause polling complete"),--r||n()})),this.writable||(d("we are currently writing - waiting to pause"),r++,this.once("drain",function(){d("pre-pause writing complete"),--r||n()}))}else n()}},{key:"poll",value:function(){d("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(e){var t=this;d("polling got data %s",e);l.decodePayload(e,this.socket.binaryType).forEach(function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():d('ignoring poll - transport state "%s"',this.readyState))}},{key:"doClose",value:function(){var e=this;function t(){d("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(d("transport open - closing"),t()):(d("transport not open - deferring close"),this.once("open",t))}},{key:"write",value:function(e){var t=this;this.writable=!1,l.encodePayload(e,function(e){t.doWrite(e,function(){t.writable=!0,t.emit("drain")})})}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",n="";return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=h()),this.supportsBinary||e.sid||(e.b64=1),e=c.encode(e),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),e.length&&(e="?"+e),t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}},{key:"name",get:function(){return"polling"}}])&&i(t.prototype,n),r&&i(t,r),f}();e.exports=f},"./node_modules/engine.io-client/lib/transports/websocket-constructor.browser.js":function(e,t,n){var r=n("./node_modules/engine.io-client/lib/globalThis.browser.js");e.exports={WebSocket:r.WebSocket||r.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},"./node_modules/engine.io-client/lib/transports/websocket.js":function(e,t,n){function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=n("./node_modules/engine.io-client/lib/transport.js"),c=n("./node_modules/engine.io-parser/lib/index.js"),l=n("./node_modules/parseqs/index.js"),h=n("./node_modules/yeast/index.js"),d=n("./node_modules/engine.io-client/lib/util.js").pick,f=n("./node_modules/engine.io-client/lib/transports/websocket-constructor.browser.js"),p=f.WebSocket,g=f.usingBrowserWebSocket,m=f.defaultBinaryType,v=n("./node_modules/debug/src/browser.js")("engine.io-client:websocket"),y="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(f,u);var t,n,r,a=s(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=a.call(this,e)).supportsBinary=!e.forceBase64,t}return t=f,(n=[{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=y?{}:d(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=g&&!y?t?new p(e,t):new p(e):new p(e,t,n)}catch(e){return this.emit("error",e)}this.ws.binaryType=this.socket.binaryType||m,this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,i=n;r<i;r++)!function(e){c.encodePacket(e,t.supportsBinary,function(r){var i={};g||(e.options&&(i.compress=e.options.compress),t.opts.perMessageDeflate&&("string"==typeof r?Buffer.byteLength(r):r.length)<t.opts.perMessageDeflate.threshold&&(i.compress=!1));try{g?t.ws.send(r):t.ws.send(r,i)}catch(e){v("websocket closed before onclose event")}--n||o()})}(e[r]);function o(){t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0)}}},{key:"onClose",value:function(){u.prototype.onClose.call(this)}},{key:"doClose",value:function(){void 0!==this.ws&&this.ws.close()}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",n="";return this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=h()),this.supportsBinary||(e.b64=1),(e=l.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}},{key:"check",value:function(){return!(!p||"__initialize"in p&&this.name===f.prototype.name)}},{key:"name",get:function(){return"websocket"}}])&&i(t.prototype,n),r&&i(t,r),f}();e.exports=b},"./node_modules/engine.io-client/lib/util.js":function(e,t){e.exports.pick=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce(function(t,n){return t[n]=e[n],t},{})}},"./node_modules/engine.io-client/lib/xmlhttprequest.js":function(e,t,n){var r=n("./node_modules/has-cors/index.js"),i=n("./node_modules/engine.io-client/lib/globalThis.browser.js");e.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},"./node_modules/engine.io-parser/lib/commons.js":function(e,t){var n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";var r=Object.create(null);Object.keys(n).forEach(function(e){r[n[e]]=e});e.exports={PACKET_TYPES:n,PACKET_TYPES_REVERSE:r,ERROR_PACKET:{type:"error",data:"parser error"}}},"./node_modules/engine.io-parser/lib/decodePacket.browser.js":function(e,t,n){var r,i=n("./node_modules/engine.io-parser/lib/commons.js"),o=i.PACKET_TYPES_REVERSE,s=i.ERROR_PACKET;"function"==typeof ArrayBuffer&&(r=n("./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var a=function(e,t){if(r){var n=r.decode(e);return u(n,t)}return{base64:!0,data:e}},u=function(e,t){switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}};e.exports=function(e,t){if("string"!=typeof e)return{type:"message",data:u(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:a(e.substring(1),t)}:o[n]?e.length>1?{type:o[n],data:e.substring(1)}:{type:o[n]}:s}},"./node_modules/engine.io-parser/lib/encodePacket.browser.js":function(e,t,n){var r=n("./node_modules/engine.io-parser/lib/commons.js").PACKET_TYPES,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),o="function"==typeof ArrayBuffer,s=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)};e.exports=function(e,t,n){var a,u=e.type,c=e.data;return i&&c instanceof Blob?t?n(c):s(c,n):o&&(c instanceof ArrayBuffer||(a=c,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer instanceof ArrayBuffer))?t?n(c instanceof ArrayBuffer?c:c.buffer):s(new Blob([c]),n):n(r[u]+(c||""))}},"./node_modules/engine.io-parser/lib/index.js":function(e,t,n){var r=n("./node_modules/engine.io-parser/lib/encodePacket.browser.js"),i=n("./node_modules/engine.io-parser/lib/decodePacket.browser.js"),o=String.fromCharCode(30);e.exports={protocol:4,encodePacket:r,encodePayload:function(e,t){var n=e.length,i=new Array(n),s=0;e.forEach(function(e,a){r(e,!1,function(e){i[a]=e,++s===n&&t(i.join(o))})})},decodePacket:i,decodePayload:function(e,t){for(var n=e.split(o),r=[],s=0;s<n.length;s++){var a=i(n[s],t);if(r.push(a),"error"===a.type)break}return r}}},"./node_modules/has-cors/index.js":function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},"./node_modules/ms/index.js":function(e,t){function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=1e3,i=60*r,o=60*i,s=24*o,a=7*s,u=365.25*s;function c(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var l=n(e);if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*u;case"weeks":case"week":case"w":return n*a;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===l&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=s)return c(e,t,s,"day");if(t>=o)return c(e,t,o,"hour");if(t>=i)return c(e,t,i,"minute");if(t>=r)return c(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=s)return Math.round(e/s)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"./node_modules/parseqs/index.js":function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},"./node_modules/parseuri/index.js":function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var s,a,u=n.exec(e||""),c={},l=14;l--;)c[r[l]]=u[l]||"";return-1!=i&&-1!=o&&(c.source=t,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1);"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1);return n}(0,c.path),c.queryKey=(s=c.query,a={},s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(a[t]=n)}),a),c}},"./node_modules/process/browser.js":function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],l=!1,h=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&f())}function f(){if(!l){var e=a(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/socket.io-parser/dist/binary.js":function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructPacket=t.deconstructPacket=void 0;var i=n("./node_modules/socket.io-parser/dist/is-binary.js");t.deconstructPacket=function(e){var t=[],n=e.data,o=e;return o.data=function e(t,n){if(!t)return t;if(i.isBinary(t)){var o={_placeholder:!0,num:n.length};return n.push(t),o}if(Array.isArray(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a],n);return s}if("object"===r(t)&&!(t instanceof Date)){var u={};for(var c in t)t.hasOwnProperty(c)&&(u[c]=e(t[c],n));return u}return t}(n,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"===r(t))for(var o in t)t.hasOwnProperty(o)&&(t[o]=e(t[o],n));return t}(e.data,t),e.attachments=void 0,e}},"./node_modules/socket.io-parser/dist/index.js":function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.Encoder=t.PacketType=t.protocol=void 0;var h,d=n("./node_modules/component-emitter/index.js"),f=n("./node_modules/socket.io-parser/dist/binary.js"),p=n("./node_modules/socket.io-parser/dist/is-binary.js"),g=n("./node_modules/debug/src/browser.js")("socket.io-parser");t.protocol=5,function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(h=t.PacketType||(t.PacketType={}));var m=function(){function e(){u(this,e)}return l(e,[{key:"encode",value:function(e){return g("encoding packet %j",e),e.type!==h.EVENT&&e.type!==h.ACK||!p.hasBinary(e)?[this.encodeAsString(e)]:(e.type=e.type===h.EVENT?h.BINARY_EVENT:h.BINARY_ACK,this.encodeAsBinary(e))}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==h.BINARY_EVENT&&e.type!==h.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),g("encoded %j as %s",e,t),t}},{key:"encodeAsBinary",value:function(e){var t=f.deconstructPacket(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}]),e}();t.Encoder=m;var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,d);var t=s(n);function n(){return u(this,n),t.call(this)}return l(n,[{key:"add",value:function(e){var t;if("string"==typeof e)(t=this.decodeString(e)).type===h.BINARY_EVENT||t.type===h.BINARY_ACK?(this.reconstructor=new y(t),0===t.attachments&&i(a(n.prototype),"emit",this).call(this,"decoded",t)):i(a(n.prototype),"emit",this).call(this,"decoded",t);else{if(!p.isBinary(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,i(a(n.prototype),"emit",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,r={type:Number(e.charAt(0))};if(void 0===h[r.type])throw new Error("unknown packet type "+r.type);if(r.type===h.BINARY_EVENT||r.type===h.BINARY_ACK){for(var i=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var o=e.substring(i,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===e.charAt(t+1)){for(var s=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(s,t)}else r.nsp="/";var a=e.charAt(t+1);if(""!==a&&Number(a)==a){for(var u=t+1;++t;){var c=e.charAt(t);if(null==c||Number(c)!=c){--t;break}if(t===e.length)break}r.id=Number(e.substring(u,t+1))}if(e.charAt(++t)){var l=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!n.isPayloadValid(r.type,l))throw new Error("invalid payload");r.data=l}return g("decoded %s as %j",e,r),r}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case h.CONNECT:return"object"===r(t);case h.DISCONNECT:return void 0===t;case h.CONNECT_ERROR:return"string"==typeof t||"object"===r(t);case h.EVENT:case h.BINARY_EVENT:return Array.isArray(t)&&"string"==typeof t[0];case h.ACK:case h.BINARY_ACK:return Array.isArray(t)}}}]),n}();t.Decoder=v;var y=function(){function e(t){u(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return l(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=f.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}()},"./node_modules/socket.io-parser/dist/is-binary.js":function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.hasBinary=t.isBinary=void 0;var i="function"==typeof ArrayBuffer,o=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer},s=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),u="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);function c(e){return i&&(e instanceof ArrayBuffer||o(e))||a&&e instanceof Blob||u&&e instanceof File}t.isBinary=c,t.hasBinary=function e(t,n){if(!t||"object"!==r(t))return!1;if(Array.isArray(t)){for(var i=0,o=t.length;i<o;i++)if(e(t[i]))return!0;return!1}if(c(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e(t[s]))return!0;return!1}},"./node_modules/yeast/index.js":function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,s={},a=0,u=0;function c(e){var t="";do{t=i[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function l(){var e=c(+new Date);return e!==r?(a=0,r=e):e+"."+c(a++)}for(;u<o;u++)s[i[u]]=u;l.encode=c,l.decode=function(e){var t=0;for(u=0;u<e.length;u++)t=t*o+s[e.charAt(u)];return t},e.exports=l}})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("underscore",t):(e=e||self,function(){var n=e._,r=e._=t();r.noConflict=function(){return e._=n,r}}())}(this,function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},t=Array.prototype,n=Object.prototype,r="undefined"!=typeof Symbol?Symbol.prototype:null,i=t.push,o=t.slice,s=n.toString,a=n.hasOwnProperty,u="undefined"!=typeof ArrayBuffer,c="undefined"!=typeof DataView,l=Array.isArray,h=Object.keys,d=Object.create,f=u&&ArrayBuffer.isView,p=isNaN,g=isFinite,m=!{toString:null}.propertyIsEnumerable("toString"),v=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],y=Math.pow(2,53)-1;function b(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=r,e.apply(this,o)}}function w(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function k(e){return void 0===e}function _(e){return!0===e||!1===e||"[object Boolean]"===s.call(e)}function x(e){var t="[object "+e+"]";return function(e){return s.call(e)===t}}var C=x("String"),S=x("Number"),T=x("Date"),j=x("RegExp"),E=x("Error"),O=x("Symbol"),A=x("ArrayBuffer"),R=x("Function"),P=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof P&&(R=function(e){return"function"==typeof e||!1});var I=R,M=x("Object"),N=c&&M(new DataView(new ArrayBuffer(8))),$="undefined"!=typeof Map&&M(new Map),U=x("DataView");var B=N?function(e){return null!=e&&I(e.getInt8)&&A(e.buffer)}:U,F=l||x("Array");function L(e,t){return null!=e&&a.call(e,t)}var D=x("Arguments");!function(){D(arguments)||(D=function(e){return L(e,"callee")})}();var W=D;function V(e){return S(e)&&p(e)}function z(e){return function(){return e}}function q(e){return function(t){var n=e(t);return"number"==typeof n&&n>=0&&n<=y}}function H(e){return function(t){return null==t?void 0:t[e]}}var J=H("byteLength"),K=q(J),G=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Y=u?function(e){return f?f(e)&&!B(e):K(e)&&G.test(s.call(e))}:z(!1),X=H("length");function Q(e,t){t=function(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return{contains:function(e){return t[e]},push:function(n){return t[n]=!0,e.push(n)}}}(t);var r=v.length,i=e.constructor,o=I(i)&&i.prototype||n,s="constructor";for(L(e,s)&&!t.contains(s)&&t.push(s);r--;)(s=v[r])in e&&e[s]!==o[s]&&!t.contains(s)&&t.push(s)}function Z(e){if(!w(e))return[];if(h)return h(e);var t=[];for(var n in e)L(e,n)&&t.push(n);return m&&Q(e,t),t}function ee(e,t){var n=Z(t),r=n.length;if(null==e)return!r;for(var i=Object(e),o=0;o<r;o++){var s=n[o];if(t[s]!==i[s]||!(s in i))return!1}return!0}function te(e){return e instanceof te?e:this instanceof te?void(this._wrapped=e):new te(e)}function ne(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,J(e))}te.VERSION="1.12.0",te.prototype.value=function(){return this._wrapped},te.prototype.valueOf=te.prototype.toJSON=te.prototype.value,te.prototype.toString=function(){return String(this._wrapped)};var re="[object DataView]";function ie(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;return("function"===o||"object"===o||"object"==typeof t)&&function e(t,n,i,o){t instanceof te&&(t=t._wrapped);n instanceof te&&(n=n._wrapped);var a=s.call(t);if(a!==s.call(n))return!1;if(N&&"[object Object]"==a&&B(t)){if(!B(n))return!1;a=re}switch(a){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return r.valueOf.call(t)===r.valueOf.call(n);case"[object ArrayBuffer]":case re:return e(ne(t),ne(n),i,o)}var u="[object Array]"===a;if(!u&&Y(t)){var c=J(t);if(c!==J(n))return!1;if(t.buffer===n.buffer&&t.byteOffset===n.byteOffset)return!0;u=!0}if(!u){if("object"!=typeof t||"object"!=typeof n)return!1;var l=t.constructor,h=n.constructor;if(l!==h&&!(I(l)&&l instanceof l&&I(h)&&h instanceof h)&&"constructor"in t&&"constructor"in n)return!1}i=i||[];o=o||[];var d=i.length;for(;d--;)if(i[d]===t)return o[d]===n;i.push(t);o.push(n);if(u){if((d=t.length)!==n.length)return!1;for(;d--;)if(!ie(t[d],n[d],i,o))return!1}else{var f,p=Z(t);if(d=p.length,Z(n).length!==d)return!1;for(;d--;)if(f=p[d],!L(n,f)||!ie(t[f],n[f],i,o))return!1}i.pop();o.pop();return!0}(e,t,n,i)}function oe(e){if(!w(e))return[];var t=[];for(var n in e)t.push(n);return m&&Q(e,t),t}function se(e){var t=X(e);return function(n){if(null==n)return!1;var r=oe(n);if(X(r))return!1;for(var i=0;i<t;i++)if(!I(n[e[i]]))return!1;return e!==he||!I(n[ae])}}var ae="forEach",ue=["clear","delete"],ce=["get","has","set"],le=ue.concat(ae,ce),he=ue.concat(ce),de=["add"].concat(ue,ae,"has"),fe=$?se(le):x("Map"),pe=$?se(he):x("WeakMap"),ge=$?se(de):x("Set"),me=x("WeakSet");function ve(e){for(var t=Z(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r}function ye(e){for(var t={},n=Z(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t}function be(e){var t=[];for(var n in e)I(e[n])&&t.push(n);return t.sort()}function we(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],s=e(o),a=s.length,u=0;u<a;u++){var c=s[u];t&&void 0!==n[c]||(n[c]=o[c])}return n}}var ke=we(oe),_e=we(Z),xe=we(oe,!0);function Ce(e){if(!w(e))return{};if(d)return d(e);var t=function(){};t.prototype=e;var n=new t;return t.prototype=null,n}function Se(e){return w(e)?F(e)?e.slice():ke({},e):e}function Te(e){return F(e)?e:[e]}function je(e){return te.toPath(e)}function Ee(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0}function Oe(e,t,n){var r=Ee(e,je(t));return k(r)?n:r}function Ae(e){return e}function Re(e){return e=_e({},e),function(t){return ee(t,e)}}function Pe(e){return e=je(e),function(t){return Ee(t,e)}}function Ie(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return function(){return e.apply(t,arguments)}}function Me(e,t,n){return null==e?Ae:I(e)?Ie(e,t,n):w(e)&&!F(e)?Re(e):Pe(e)}function Ne(e,t){return Me(e,t,1/0)}function $e(e,t,n){return te.iteratee!==Ne?te.iteratee(e,t):Me(e,t,n)}function Ue(){}function Be(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}te.toPath=Te,te.iteratee=Ne;var Fe=Date.now||function(){return(new Date).getTime()};function Le(e){var t=function(t){return e[t]},n="(?:"+Z(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}}var De={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},We=Le(De),Ve=Le(ye(De)),ze=te.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},qe=/(.)^/,He={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Je=/\\|'|\r|\n|\u2028|\u2029/g;function Ke(e){return"\\"+He[e]}var Ge=0;function Ye(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var o=Ce(e.prototype),s=e.apply(o,i);return w(s)?s:o}var Xe=b(function(e,t){var n=Xe.placeholder,r=function(){for(var i=0,o=t.length,s=Array(o),a=0;a<o;a++)s[a]=t[a]===n?arguments[i++]:t[a];for(;i<arguments.length;)s.push(arguments[i++]);return Ye(e,r,this,this,s)};return r});Xe.placeholder=te;var Qe=b(function(e,t,n){if(!I(e))throw new TypeError("Bind must be called on a function");var r=b(function(i){return Ye(e,r,t,this,n.concat(i))});return r}),Ze=q(X);function et(e,t,n,r){if(r=r||[],t||0===t){if(t<=0)return r.concat(e)}else t=1/0;for(var i=r.length,o=0,s=X(e);o<s;o++){var a=e[o];if(Ze(a)&&(F(a)||W(a)))if(t>1)et(a,t-1,n,r),i=r.length;else for(var u=0,c=a.length;u<c;)r[i++]=a[u++];else n||(r[i++]=a)}return r}var tt=b(function(e,t){var n=(t=et(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=Qe(e[r],e)}return e});var nt=b(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),rt=Xe(nt,te,1);function it(e){return function(){return!e.apply(this,arguments)}}function ot(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var st=Xe(ot,2);function at(e,t,n){t=$e(t,n);for(var r,i=Z(e),o=0,s=i.length;o<s;o++)if(t(e[r=i[o]],r,e))return r}function ut(e){return function(t,n,r){n=$e(n,r);for(var i=X(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(n(t[o],o,t))return o;return-1}}var ct=ut(1),lt=ut(-1);function ht(e,t,n,r){for(var i=(n=$e(n,r,1))(t),o=0,s=X(e);o<s;){var a=Math.floor((o+s)/2);n(e[a])<i?o=a+1:s=a}return o}function dt(e,t,n){return function(r,i,s){var a=0,u=X(r);if("number"==typeof s)e>0?a=s>=0?s:Math.max(s+u,a):u=s>=0?Math.min(s+1,u):s+u+1;else if(n&&s&&u)return r[s=n(r,i)]===i?s:-1;if(i!=i)return(s=t(o.call(r,a,u),V))>=0?s+a:-1;for(s=e>0?a:u-1;s>=0&&s<u;s+=e)if(r[s]===i)return s;return-1}}var ft=dt(1,ct,ht),pt=dt(-1,lt);function gt(e,t,n){var r=(Ze(e)?ct:at)(e,t,n);if(void 0!==r&&-1!==r)return e[r]}function mt(e,t,n){var r,i;if(t=Ie(t,n),Ze(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=Z(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e}function vt(e,t,n){t=$e(t,n);for(var r=!Ze(e)&&Z(e),i=(r||e).length,o=Array(i),s=0;s<i;s++){var a=r?r[s]:s;o[s]=t(e[a],a,e)}return o}function yt(e){return function(t,n,r,i){var o=arguments.length>=3;return function(t,n,r,i){var o=!Ze(t)&&Z(t),s=(o||t).length,a=e>0?0:s-1;for(i||(r=t[o?o[a]:a],a+=e);a>=0&&a<s;a+=e){var u=o?o[a]:a;r=n(r,t[u],u,t)}return r}(t,Ie(n,i,4),r,o)}}var bt=yt(1),wt=yt(-1);function kt(e,t,n){var r=[];return t=$e(t,n),mt(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}function _t(e,t,n){t=$e(t,n);for(var r=!Ze(e)&&Z(e),i=(r||e).length,o=0;o<i;o++){var s=r?r[o]:o;if(!t(e[s],s,e))return!1}return!0}function xt(e,t,n){t=$e(t,n);for(var r=!Ze(e)&&Z(e),i=(r||e).length,o=0;o<i;o++){var s=r?r[o]:o;if(t(e[s],s,e))return!0}return!1}function Ct(e,t,n,r){return Ze(e)||(e=ve(e)),("number"!=typeof n||r)&&(n=0),ft(e,t,n)>=0}var St=b(function(e,t,n){var r,i;return I(t)?i=t:(t=je(t),r=t.slice(0,-1),t=t[t.length-1]),vt(e,function(e){var o=i;if(!o){if(r&&r.length&&(e=Ee(e,r)),null==e)return;o=e[t]}return null==o?o:o.apply(e,n)})});function Tt(e,t){return vt(e,Pe(t))}function jt(e,t,n){var r,i,o=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,u=(e=Ze(e)?e:ve(e)).length;a<u;a++)null!=(r=e[a])&&r>o&&(o=r);else t=$e(t,n),mt(e,function(e,n,r){((i=t(e,n,r))>s||i===-1/0&&o===-1/0)&&(o=e,s=i)});return o}function Et(e,t,n){if(null==t||n)return Ze(e)||(e=ve(e)),e[Be(e.length-1)];var r=Ze(e)?Se(e):ve(e),i=X(r);t=Math.max(Math.min(t,i),0);for(var o=i-1,s=0;s<t;s++){var a=Be(s,o),u=r[s];r[s]=r[a],r[a]=u}return r.slice(0,t)}function Ot(e,t){return function(n,r,i){var o=t?[[],[]]:{};return r=$e(r,i),mt(n,function(t,i){var s=r(t,i,n);e(o,t,s)}),o}}var At=Ot(function(e,t,n){L(e,n)?e[n].push(t):e[n]=[t]}),Rt=Ot(function(e,t,n){e[n]=t}),Pt=Ot(function(e,t,n){L(e,n)?e[n]++:e[n]=1}),It=Ot(function(e,t,n){e[n?0:1].push(t)},!0),Mt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Nt(e,t,n){return t in n}var $t=b(function(e,t){var n={},r=t[0];if(null==e)return n;I(r)?(t.length>1&&(r=Ie(r,t[1])),t=oe(e)):(r=Nt,t=et(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var s=t[i],a=e[s];r(a,s,e)&&(n[s]=a)}return n}),Ut=b(function(e,t){var n,r=t[0];return I(r)?(r=it(r),t.length>1&&(n=t[1])):(t=vt(et(t,!1,!1),String),r=function(e,n){return!Ct(t,n)}),$t(e,r,n)});function Bt(e,t,n){return o.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function Ft(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:Bt(e,e.length-t)}function Lt(e,t,n){return o.call(e,null==t||n?1:t)}var Dt=b(function(e,t){return t=et(t,!0,!0),kt(e,function(e){return!Ct(t,e)})}),Wt=b(function(e,t){return Dt(e,t)});function Vt(e,t,n,r){_(t)||(r=n,n=t,t=!1),null!=n&&(n=$e(n,r));for(var i=[],o=[],s=0,a=X(e);s<a;s++){var u=e[s],c=n?n(u,s,e):u;t&&!n?(s&&o===c||i.push(u),o=c):n?Ct(o,c)||(o.push(c),i.push(u)):Ct(i,u)||i.push(u)}return i}var zt=b(function(e){return Vt(et(e,!0,!0))});function qt(e){for(var t=e&&jt(e,X).length||0,n=Array(t),r=0;r<t;r++)n[r]=Tt(e,r);return n}var Ht=b(qt);function Jt(e,t){return e._chain?te(t).chain():t}function Kt(e){return mt(be(e),function(t){var n=te[t]=e[t];te.prototype[t]=function(){var e=[this._wrapped];return i.apply(e,arguments),Jt(this,n.apply(te,e))}}),te}mt(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=t[e];te.prototype[e]=function(){var t=this._wrapped;return null!=t&&(n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0]),Jt(this,t)}}),mt(["concat","join","slice"],function(e){var n=t[e];te.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=n.apply(e,arguments)),Jt(this,e)}});var Gt=Kt({__proto__:null,VERSION:"1.12.0",restArguments:b,isObject:w,isNull:function(e){return null===e},isUndefined:k,isBoolean:_,isElement:function(e){return!(!e||1!==e.nodeType)},isString:C,isNumber:S,isDate:T,isRegExp:j,isError:E,isSymbol:O,isArrayBuffer:A,isDataView:B,isArray:F,isFunction:I,isArguments:W,isFinite:function(e){return!O(e)&&g(e)&&!isNaN(parseFloat(e))},isNaN:V,isTypedArray:Y,isEmpty:function(e){if(null==e)return!0;var t=X(e);return"number"==typeof t&&(F(e)||C(e)||W(e))?0===t:0===X(Z(e))},isMatch:ee,isEqual:function(e,t){return ie(e,t)},isMap:fe,isWeakMap:pe,isSet:ge,isWeakSet:me,keys:Z,allKeys:oe,values:ve,pairs:function(e){for(var t=Z(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},invert:ye,functions:be,methods:be,extend:ke,extendOwn:_e,assign:_e,defaults:xe,create:function(e,t){var n=Ce(e);return t&&_e(n,t),n},clone:Se,tap:function(e,t){return t(e),e},get:Oe,has:function(e,t){for(var n=(t=je(t)).length,r=0;r<n;r++){var i=t[r];if(!L(e,i))return!1;e=e[i]}return!!n},mapObject:function(e,t,n){t=$e(t,n);for(var r=Z(e),i=r.length,o={},s=0;s<i;s++){var a=r[s];o[a]=t(e[a],a,e)}return o},identity:Ae,constant:z,noop:Ue,toPath:Te,property:Pe,propertyOf:function(e){return null==e?Ue:function(t){return Oe(e,t)}},matcher:Re,matches:Re,times:function(e,t,n){var r=Array(Math.max(0,e));t=Ie(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},random:Be,now:Fe,escape:We,unescape:Ve,templateSettings:ze,template:function(e,t,n){!t&&n&&(t=n),t=xe({},t,te.templateSettings);var r,i=RegExp([(t.escape||qe).source,(t.interpolate||qe).source,(t.evaluate||qe).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(i,function(t,n,r,i,a){return s+=e.slice(o,a).replace(Je,Ke),o=a+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var a=function(e){return r.call(this,e,te)},u=t.variable||"obj";return a.source="function("+u+"){\n"+s+"}",a},result:function(e,t,n){var r=(t=je(t)).length;if(!r)return I(n)?n.call(e):n;for(var i=0;i<r;i++){var o=null==e?void 0:e[t[i]];void 0===o&&(o=n,i=r),e=I(o)?o.call(e):o}return e},uniqueId:function(e){var t=++Ge+"";return e?e+t:t},chain:function(e){var t=te(e);return t._chain=!0,t},iteratee:Ne,partial:Xe,bind:Qe,bindAll:tt,memoize:function(e,t){var n=function(r){var i=n.cache,o=""+(t?t.apply(this,arguments):r);return L(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return n.cache={},n},delay:nt,defer:rt,throttle:function(e,t,n){var r,i,o,s,a=0;n||(n={});var u=function(){a=!1===n.leading?0:Fe(),r=null,s=e.apply(i,o),r||(i=o=null)},c=function(){var c=Fe();a||!1!==n.leading||(a=c);var l=t-(c-a);return i=this,o=arguments,l<=0||l>t?(r&&(clearTimeout(r),r=null),a=c,s=e.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(u,l)),s};return c.cancel=function(){clearTimeout(r),a=0,r=i=o=null},c},debounce:function(e,t,n){var r,i,o=function(t,n){r=null,n&&(i=e.apply(t,n))},s=b(function(s){if(r&&clearTimeout(r),n){var a=!r;r=setTimeout(o,t),a&&(i=e.apply(this,s))}else r=nt(o,t,this,s);return i});return s.cancel=function(){clearTimeout(r),r=null},s},wrap:function(e,t){return Xe(t,e)},negate:it,compose:function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:ot,once:st,findKey:at,findIndex:ct,findLastIndex:lt,sortedIndex:ht,indexOf:ft,lastIndexOf:pt,find:gt,detect:gt,findWhere:function(e,t){return gt(e,Re(t))},each:mt,forEach:mt,map:vt,collect:vt,reduce:bt,foldl:bt,inject:bt,reduceRight:wt,foldr:wt,filter:kt,select:kt,reject:function(e,t,n){return kt(e,it($e(t)),n)},every:_t,all:_t,some:xt,any:xt,contains:Ct,includes:Ct,include:Ct,invoke:St,pluck:Tt,where:function(e,t){return kt(e,Re(t))},max:jt,min:function(e,t,n){var r,i,o=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,u=(e=Ze(e)?e:ve(e)).length;a<u;a++)null!=(r=e[a])&&r<o&&(o=r);else t=$e(t,n),mt(e,function(e,n,r){((i=t(e,n,r))<s||i===1/0&&o===1/0)&&(o=e,s=i)});return o},shuffle:function(e){return Et(e,1/0)},sample:Et,sortBy:function(e,t,n){var r=0;return t=$e(t,n),Tt(vt(e,function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")},groupBy:At,indexBy:Rt,countBy:Pt,partition:It,toArray:function(e){return e?F(e)?o.call(e):C(e)?e.match(Mt):Ze(e)?vt(e,Ae):ve(e):[]},size:function(e){return null==e?0:Ze(e)?e.length:Z(e).length},pick:$t,omit:Ut,first:Ft,head:Ft,take:Ft,initial:Bt,last:function(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:Lt(e,Math.max(0,e.length-t))},rest:Lt,tail:Lt,drop:Lt,compact:function(e){return kt(e,Boolean)},flatten:function(e,t){return et(e,t,!1)},without:Wt,uniq:Vt,unique:Vt,union:zt,intersection:function(e){for(var t=[],n=arguments.length,r=0,i=X(e);r<i;r++){var o=e[r];if(!Ct(t,o)){var s;for(s=1;s<n&&Ct(arguments[s],o);s++);s===n&&t.push(o)}}return t},difference:Dt,unzip:qt,transpose:qt,zip:Ht,object:function(e,t){for(var n={},r=0,i=X(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},range:function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;o<r;o++,e+=n)i[o]=e;return i},chunk:function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(o.call(e,r,r+=t));return n},mixin:Kt,default:te});return Gt._=Gt,Gt}),function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,r,i){t.Backbone=e(t,i,n,r)});else if("undefined"!=typeof exports){var n,r=require("underscore");try{n=require("jquery")}catch(e){}e(t,exports,r,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,r){var i=e.Backbone,o=Array.prototype.slice;t.VERSION="1.4.0",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s,a=t.Events={},u=/\s+/,c=function(e,t,r,i,o){var s,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in o&&void 0===o.context&&(o.context=i);for(s=n.keys(r);a<s.length;a++)t=c(e,t,s[a],r[s[a]],o)}else if(r&&u.test(r))for(s=r.split(u);a<s.length;a++)t=e(t,s[a],i,o);else t=e(t,r,i,o);return t};a.on=function(e,t,n){(this._events=c(l,this._events||{},e,t,{context:n,ctx:this,listening:s}),s)&&((this._listeners||(this._listeners={}))[s.id]=s,s.interop=!1);return this},a.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=s=o[i];a||(this._listenId||(this._listenId=n.uniqueId("l")),a=s=o[i]=new m(this,e));var u=h(e,t,r,this);if(s=void 0,u)throw u;return a.interop&&a.on(t,r),this};var l=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return e},h=function(e,t,n,r){try{e.on(t,n,r)}catch(e){return e}};a.off=function(e,t,n){return this._events?(this._events=c(d,this._events,e,t,{context:n,listeners:this._listeners}),this):this},a.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;for(var o=e?[e._listenId]:n.keys(i),s=0;s<o.length;s++){var a=i[o[s]];if(!a)break;a.obj.off(t,r,this),a.interop&&a.off(t,r)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var d=function(e,t,r,i){if(e){var o,s=i.context,a=i.listeners,u=0;if(t||s||r){for(o=t?[t]:n.keys(e);u<o.length;u++){var c=e[t=o[u]];if(!c)break;for(var l=[],h=0;h<c.length;h++){var d=c[h];if(r&&r!==d.callback&&r!==d.callback._callback||s&&s!==d.context)l.push(d);else{var f=d.listening;f&&f.off(t,r)}}l.length?e[t]=l:delete e[t]}return e}for(o=n.keys(a);u<o.length;u++)a[o[u]].cleanup()}};a.once=function(e,t,n){var r=c(f,{},e,t,this.off.bind(this));return"string"==typeof e&&null==n&&(t=void 0),this.on(r,t,n)},a.listenToOnce=function(e,t,n){var r=c(f,{},t,n,this.stopListening.bind(this,e));return this.listenTo(e,r)};var f=function(e,t,r,i){if(r){var o=e[t]=n.once(function(){i(t,o),r.apply(this,arguments)});o._callback=r}return e};a.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),r=0;r<t;r++)n[r]=arguments[r+1];return c(p,this._events,e,void 0,n),this};var p=function(e,t,n,r){if(e){var i=e[t],o=e.all;i&&o&&(o=o.slice()),i&&g(i,r),o&&g(o,[t].concat(r))}return e},g=function(e,t){var n,r=-1,i=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}},m=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};m.prototype.on=a.on,m.prototype.off=function(e,t){var n;this.interop?(this._events=c(d,this._events,e,t,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},m.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},a.bind=a.on,a.unbind=a.off,n.extend(t,a);var v=t.Model=function(e,t){var r=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{});var i=n.result(this,"defaults");r=n.defaults(n.extend({},i,r),i),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(v.prototype,a,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(null==e)return this;var i;if("object"==typeof e?(i=e,r=t):(i={})[e]=t,r||(r={}),!this._validate(i,r))return!1;var o=r.unset,s=r.silent,a=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,l=this.changed,h=this._previousAttributes;for(var d in i)t=i[d],n.isEqual(c[d],t)||a.push(d),n.isEqual(h[d],t)?delete l[d]:l[d]=t,o?delete c[d]:c[d]=t;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=r);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,c[a[f]],r)}if(u)return this;if(!s)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t,r=this._changing?this._previousAttributes:this.attributes,i={};for(var o in e){var s=e[o];n.isEqual(r[o],s)||(i[o]=s,t=!0)}return!!t&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},z(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;null==e||"object"==typeof e?(i=e,r=t):(i={})[e]=t;var o=(r=n.extend({validate:!0,parse:!0},r)).wait;if(i&&!o){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var s=this,a=r.success,u=this.attributes;r.success=function(e){s.attributes=u;var t=r.parse?s.parse(e,r):e;if(o&&(t=n.extend({},i,t)),t&&!s.set(t,r))return!1;a&&a.call(r.context,s,e,r),s.trigger("sync",s,e,r)},z(this,r),i&&o&&(this.attributes=n.extend({},u,i));var c=this.isNew()?"create":r.patch?"patch":"update";"patch"!==c||r.attrs||(r.attrs=i);var l=this.sync(c,this,r);return this.attributes=u,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,o=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&o(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var s=!1;return this.isNew()?n.defer(e.success):(z(this,e),s=this.sync("delete",this,e)),i||o(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||V();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1)}});var y=t.Collection=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},b={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},k=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r,i=Array(e.length-n),o=t.length;for(r=0;r<i.length;r++)i[r]=e[r+n];for(r=0;r<o;r++)e[r+n]=t[r];for(r=0;r<i.length;r++)e[r+o+n]=i[r]};n.extend(y.prototype,a,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,w))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:e.slice();var i=this._removeModels(e,t);return!t.silent&&i.length&&(t.changes={added:[],merged:[],removed:i},this.trigger("update",this,t)),r?i[0]:i},set:function(e,t){if(null!=e){(t=n.extend({},b,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;null!=i&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var o,s,a=[],u=[],c=[],l=[],h={},d=t.add,f=t.merge,p=t.remove,g=!1,m=this.comparator&&null==i&&!1!==t.sort,v=n.isString(this.comparator)?this.comparator:null;for(s=0;s<e.length;s++){o=e[s];var y=this.get(o);if(y){if(f&&o!==y){var w=this._isModel(o)?o.attributes:o;t.parse&&(w=y.parse(w,t)),y.set(w,t),c.push(y),m&&!g&&(g=y.hasChanged(v))}h[y.cid]||(h[y.cid]=!0,a.push(y)),e[s]=y}else d&&(o=e[s]=this._prepareModel(o,t))&&(u.push(o),this._addReference(o,t),h[o.cid]=!0,a.push(o))}if(p){for(s=0;s<this.length;s++)h[(o=this.models[s]).cid]||l.push(o);l.length&&this._removeModels(l,t)}var _=!1,x=!m&&d&&p;if(a.length&&x?(_=this.length!==a.length||n.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,k(this.models,a,0),this.length=this.models.length):u.length&&(m&&(g=!0),k(this.models,u,null==i?this.length:i),this.length=this.models.length),g&&this.sort({silent:!0}),!t.silent){for(s=0;s<u.length;s++)null!=i&&(t.index=i+s),(o=u[s]).trigger("add",o,this,t);(g||_)&&this.trigger("sort",this,t),(u.length||l.length||c.length)&&(t.changes={added:u,removed:l,merged:c},this.trigger("update",this,t))}return r?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return o.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=t.bind(this)),1===r||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){var t=(e=n.extend({parse:!0},e)).success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},z(this,e),this.sync("read",this,e)},create:function(e,t){var r=(t=t?n.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;r||this.add(e,t);var i=this,o=t.success;return t.success=function(e,t,n){r&&i.add(e,n),o&&o.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},values:function(){return new x(this,C)},keys:function(){return new x(this,S)},entries:function(){return new x(this,T)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?n.clone(t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){for(var n=[],r=0;r<e.length;r++){var i=this.get(e[r]);if(i){var o=this.indexOf(i);this.models.splice(o,1),this.length--,delete this._byId[i.cid];var s=this.modelId(i.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=o,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}}return n},_isModel:function(e){return e instanceof v},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,r),"change"===e){var i=this.modelId(t.previousAttributes()),o=this.modelId(t.attributes);i!==o&&(null!=i&&delete this._byId[i],null!=o&&(this._byId[o]=t))}}this.trigger.apply(this,arguments)}});var _="function"==typeof Symbol&&Symbol.iterator;_&&(y.prototype[_]=y.prototype.values);var x=function(e,t){this._collection=e,this._kind=t,this._index=0},C=1,S=2,T=3;_&&(x.prototype[_]=function(){return this}),x.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var e,t=this._collection.at(this._index);if(this._index++,this._kind===C)e=t;else{var n=this._collection.modelId(t.attributes);e=this._kind===S?n:[n,t]}return{value:e,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var j=t.View=function(e){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(e,O)),this._ensureElement(),this.initialize.apply(this,arguments)},E=/^(\S+)\s*(.*)$/,O=["model","collection","el","id","attributes","className","tagName","events"];n.extend(j.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var r=e[t];if(n.isFunction(r)||(r=this[r]),r){var i=t.match(E);this.delegate(i[1],i[2],r.bind(this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}});var A=function(e,t,r,i){n.each(r,function(n,r){t[r]&&(e.prototype[r]=function(e,t,n,r){switch(t){case 1:return function(){return e[n](this[r])};case 2:return function(t){return e[n](this[r],t)};case 3:return function(t,i){return e[n](this[r],R(t,this),i)};case 4:return function(t,i,o){return e[n](this[r],R(t,this),i,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[r]),e[n].apply(e,t)}}}(t,n,r,i))})},R=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?P(e):n.isString(e)?function(t){return t.get(e)}:e},P=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}};n.each([[y,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],function(e){var t=e[0],r=e[1],i=e[2];t.mixin=function(e){var r=n.reduce(n.functions(e),function(e,t){return e[t]=0,e},{});A(t,e,r,i)},A(t,n,r,i)}),t.sync=function(e,r,i){var o=I[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(i.url||(s.url=n.result(r,"url")||V()),null!=i.data||!r||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",i.emulateJSON&&(s.data._method=o);var a=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||i.emulateJSON||(s.processData=!1);var u=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,u&&u.call(i.context,e,t,n)};var c=i.xhr=t.ajax(n.extend(s,i));return r.trigger("request",r,c,i),c};var I={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var M=t.Router=function(e){e||(e={}),this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,$=/(\(\?)?:\w+/g,U=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(M.prototype,a,{preinitialize:function(){},initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var o=this;return t.history.route(e,function(n){var s=o._extractParameters(e,n);!1!==o.execute(i,s,r)&&(o.trigger.apply(o,["route:"+r].concat(s)),o.trigger("route",r,s),t.history.trigger("route",o,r,s))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(B,"\\$&").replace(N,"(?:$1)?").replace($,function(e,t){return t?e:"([^/?]+)"}).replace(U,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var F=t.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},L=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,W=/#.*$/;F.started=!1,n.extend(F.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(L,"")},start:function(e){if(F.started)throw new Error("Backbone.history has already been started");if(F.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(D,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var o=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),F.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!F.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");var r=n+e;e=e.replace(W,"");var i=this.decodeFragment(e);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;t.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new F;v.extend=y.extend=M.extend=j.extend=F.extend=function(e,t){var r,i=this;return r=e&&n.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,t),r.prototype=n.create(i.prototype,e),r.prototype.constructor=r,r.__super__=i.prototype,r};var V=function(){throw new Error('A "url" property or function must be specified')},z=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}),function(e){var t,n=e.R,r=!1,i={init:function(e){e=e||void 0!==typeof navigator?navigator.language:"en-GB",t.locales={},t.navLang=e,r=!0},slice:function(e){return Array.prototype.slice.call(e)},AinOf:function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},realTypeOf:function(e){return Object.prototype.toString.call(e).match(/\w+/g)[1].toLowerCase()},render:function(e,n){return t.locales&&t.locales.hasOwnProperty(t.lang)&&t.locales[t.lang].hasOwnProperty(e)&&(e=t.locales[t.lang][e]),n&&0!==n.length?(n=i.parseVariables(n),i.format(e,n)):e},parseVariables:function(e,t){var n,r;switch(t||(t={i:[],s:[],named:{}}),i.realTypeOf(e)){case"number":t.i.push(e);break;case"string":t.s.push(e);break;case"date":t.i.push(e.toString());break;case"object":for(n in e)e.hasOwnProperty(n)&&("i"===n||"s"===n?i.parseVariables(e[n],t):t.named[n]=e[n]);break;case"array":for(n=0,r=e.length;n<r;++n)i.parseVariables(e[n],t)}return t},format:function(e,t){var n,r,i,o,s,a,u={i:"%i",s:"%s"};for(s in u){if(u.hasOwnProperty(s))for(i=(e.match(new RegExp(u[s],"g"))||[]).length,n=0;n<i;++n)void 0!==(r=t[s].hasOwnProperty(n)?t[s][n]:r)&&!1!==r&&(o=e.indexOf(u[s]))>=0&&(e=e.substr(0,o)+r+e.substr(o+2));r=!1}for(n in t.named)t.named.hasOwnProperty(n)&&(a=new RegExp("%\\("+n+"\\)","g"),e=e.replace(a,t.named[n]));return e}};(t=function(e,t){if(r||i.init(),arguments.length>1){var n=i.slice(arguments);return n.shift(),i.render(e,n)}return i.render(e,[t])}).registerLocale=function(e,n){return r||i.init(),t.locales[e]=n,t.setLocale(t.navlang),t},t.localeOrder=function(){return t.preferredLocales=i.slice(arguments),t.setLocale(t.lang)},t.setLocale=function(e,n){if(r||i.init(),n)return t.lang=e,t;var o,s=t.preferredLocales;if(!s)for(o in s=[],t.locales)t.locales.hasOwnProperty(o)&&s.push(o);return(o=i.AinOf(s,e))>0?(t.lang=s[o],t):(t.lang=s[0]||e,t)},t.noConflict=function(){return e.R=n,t},e.R=t}("undefined"!=typeof module&&module.exports?module.exports:this);var i18n={init:function(){R.registerLocale("en-US",{}),R.registerLocale("hu",{"Next unread":"Köv. olvasatlan",Edit:"Szerkesztés","All read":"Mindet olvasottá","Leave conversation":"Kilépés","{{ usercount }} participants":"{{ usercount }} résztvevő","Press Return to send, Shift-Return to break line.":"Nyomj Entert a mentéshez, Shift-Entert a sortöréshez.","Save message":"Üzenet mentése","Earlier messages":"Régebbi üzenetek","Add message":"Új üzenet","new messages":"új üzenet","Reply to {{ user.name }}'s message":"Válasz {{ user.name }} üzenetére",Cancel:"Mégse",Close:"Bezárás","You have no conversations.":"Nincs aktív beszélgetésed","Add conversation":"Új beszélgetés","Add conversation +":"Új beszélgetés +",Title:"Beszélgetés címe",Participants:"Résztvevők",Create:"Létrehozás","Sign out":"Kijelentkezés","Edit conversation":"Beszélgetés szerkesztése",Save:"Mentés","Searching...":"Keresés...","User not found.":"Nincs ilyen felhasználónk.","Enter username.":"Írj be egy felhasználónevet.","Do you want to leave conversation {{ title }}?\n\nIf you want to come back later, participants can invite you":"Biztosan kilépsz a következő beszélgetésből: {{ title }}?\n\nHa később vissza szeretnél lépni, a beszélgetés résztvevői újra meghívhatnak.","Get invite code":"Meghívó igénylés","Invite URL":"Meghívó URL","Edit profile":"Profil",Name:"Név",Avatar:"Avatár",Notifications:"Értesítések","Not supported":"Nem támogatott",Enabled:"Bekapcsolva",Disabled:"Kikapcsolva",Test:"Teszt",Disconnected:"Megszakadt a kapcsolat","You're disconnected":"Megszakadt a kapcsolat","Retrying in:":"Újracsatlakozás:",Reconnect:"Újracsatlakozás most","{{ participantName }} mentioned you in {{ waveName }}!":"{{ participantName }} emlegetette a neved itt: {{ waveName }}!"}),R.setLocale(navigator.language||navigator.browserLanguage),i18n.translateTemplates(),i18n.applyR($("body"))},applyR:function(e){$(".R",e).each(function(){var e=$(this);e.prop("placeholder")&&e.prop("placeholder",R(e.prop("placeholder"))),e.html(R(e.html())).removeClass("R")})},translateTemplates:function(){var e,t,n,r,i=document.getElementsByTagName("script");for(e=0,t=i.length;e<t;e++)(n=i[e])&&n.innerHTML&&n.id&&("text/html"===n.type||"text/x-icanhaz"===n.type)&&(r=$(n.innerHTML),i18n.applyR(r),n.innerHTML=$("<div>").append(r).html())},__:function(e){return R(e)}};i18n.init();var __=i18n.__;function wordwrap(e,t,n,r){var i,o,s;if(t=arguments.length>=2?+t:75,n=arguments.length>=3?""+n:"\n",r=arguments.length>=4&&!!r,e+="",t<1)return e;var a,u=/^\S*/,c=/\S*(\s)?$/,l=e.split(/\r\n|\n|\r/),h=l.length;for(i=0;i<h;l[i++]+=s)for(s=l[i],l[i]="";s.length>t;){var d=s.slice(0,t+1),f=0,p=0;if((a=d.match(c))[1])o=t,f=1;else if((o=d.length-a[0].length)&&(p=1),!o&&r&&t&&(o=t),!o){var g=(s.slice(t).match(u)||[""])[0];o=d.length+g.length}l[i]+=s.slice(0,o-p),s=s.slice(o+f),l[i]+=s.length?n:""}return l.join("\n")}function nl2br(e,t){return null==e?"":(e+"").replace(/(\r\n|\n\r|\r|\n)/g,(t||void 0===t?"<br />":"<br>")+"$1")}function strip_tags(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})}!function(e){var t={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",prePopulate:null,processPrePopulate:!1,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:!0,theme:null,zindex:999,resultsLimit:null,enableHTML:!1,resultsFormatter:function(e){var t=e[this.propertyToSearch];return"<li>"+(this.enableHTML?t:m(t))+"</li>"},tokenFormatter:function(e){var t=e[this.propertyToSearch];return"<li><p>"+(this.enableHTML?t:m(t))+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",allowFreeTagging:!1,onResult:null,onCachedResult:null,onAdd:null,onFreeTaggingAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:!1},n={tokenList:"token-input-list",token:"token-input-token",tokenReadOnly:"token-input-token-readonly",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",focused:"token-input-focused",disabled:"token-input-disabled"},r={BEFORE:0,AFTER:1,END:2},i=8,o=9,s=13,a=27,u=37,c=38,l=39,h=40,d=108,f=188,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},g=/[&<>"'\/]/g;function m(e){return(t=e,String(null==t?"":t)).replace(g,function(e){return p[e]});var t}var v={init:function(n,r){var i=e.extend({},t,r||{});return this.each(function(){e(this).data("settings",i),e(this).data("tokenInputObject",new e.TokenList(this,n,i))})},clear:function(){return this.data("tokenInputObject").clear(),this},add:function(e){return this.data("tokenInputObject").add(e),this},remove:function(e){return this.data("tokenInputObject").remove(e),this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(e){return this.data("tokenInputObject").toggleDisabled(e),this},setOptions:function(t){return e(this).data("settings",e.extend({},e(this).data("settings"),t||{})),this}};e.fn.tokenInput=function(e){return v[e]?v[e].apply(this,Array.prototype.slice.call(arguments,1)):v.init.apply(this,arguments)},e.TokenList=function(t,p,g){if("string"===e.type(p)||"function"===e.type(p)){e(t).data("settings").url=p;var v=X();void 0===e(t).data("settings").crossDomain&&"string"==typeof v&&(-1===v.indexOf("://")?e(t).data("settings").crossDomain=!1:e(t).data("settings").crossDomain=location.href.split(/\/+/g)[1]!==v.split(/\/+/g)[1])}else"object"==typeof p&&(e(t).data("settings").local_data=p);e(t).data("settings").classes?e(t).data("settings").classes=e.extend({},n,e(t).data("settings").classes):e(t).data("settings").theme?(e(t).data("settings").classes={},e.each(n,function(n,r){e(t).data("settings").classes[n]=r+"-"+e(t).data("settings").theme})):e(t).data("settings").classes=n;var y,b,w=[],k=0,_=new e.TokenList.Cache,x=e('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",e(t).data("settings").idPrefix+t.id).focus(function(){if(e(t).data("settings").disabled)return!1;null!==e(t).data("settings").tokenLimit&&e(t).data("settings").tokenLimit===k||e(t).data("settings").hintText&&(A.html("<p>"+I(e(t).data("settings").hintText)+"</p>"),z()),E.addClass(e(t).data("settings").classes.focused)}).blur(function(){V(),e(this).val(""),E.removeClass(e(t).data("settings").classes.focused),e(t).data("settings").allowFreeTagging?$():e(this).val(""),E.removeClass(e(t).data("settings").classes.focused)}).bind("keyup keydown blur update",function(){if(b===(b=x.val()))return;R.html(m(b)),x.width(R.width()+30)}).keydown(function(n){var p,g;switch(n.keyCode){case u:case l:case c:case h:if(e(this).val()){var m=null;(m=n.keyCode===h||n.keyCode===l?e(j).next():e(j).prev()).length&&G(m)}else p=O.prev(),g=O.next(),p.length&&p.get(0)===S||g.length&&g.get(0)===S?n.keyCode===u||n.keyCode===c?L(e(S),r.BEFORE):L(e(S),r.AFTER):n.keyCode!==u&&n.keyCode!==c||!p.length?n.keyCode!==l&&n.keyCode!==h||!g.length||F(e(g.get(0))):F(e(p.get(0)));return!1;case i:if(p=O.prev(),!e(this).val().length)return S?(D(e(S)),C.change()):p.length&&F(e(p.get(0))),!1;1===e(this).val().length?V():setTimeout(function(){Y()},5);break;case o:case s:case d:case f:return j?(B(e(j).data("tokeninput")),C.change()):(e(t).data("settings").allowFreeTagging?$():e(this).val(""),n.stopPropagation(),n.preventDefault()),!1;case a:return V(),!0;default:String.fromCharCode(n.which)&&setTimeout(function(){Y()},5)}}),C=e(t).hide().val("").focus(function(){Q(x)}).blur(function(){x.blur()}),S=null,T=0,j=null,E=e("<ul />").addClass(e(t).data("settings").classes.tokenList).click(function(t){var n=e(t.target).closest("li");n&&n.get(0)&&e.data(n.get(0),"tokeninput")?function(t){var n=S;S&&L(e(S),r.END);n===t.get(0)?L(t,r.END):F(t)}(n):(S&&L(e(S),r.END),Q(x))}).mouseover(function(n){var r=e(n.target).closest("li");r&&S!==this&&r.addClass(e(t).data("settings").classes.highlightedToken)}).mouseout(function(n){var r=e(n.target).closest("li");r&&S!==this&&r.removeClass(e(t).data("settings").classes.highlightedToken)}).insertBefore(C),O=e("<li />").addClass(e(t).data("settings").classes.inputToken).appendTo(E).append(x),A=e("<div>").addClass(e(t).data("settings").classes.dropdown).appendTo("body").hide(),R=e("<tester/>").insertAfter(x).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:x.css("fontSize"),fontFamily:x.css("fontFamily"),fontWeight:x.css("fontWeight"),letterSpacing:x.css("letterSpacing"),whiteSpace:"nowrap"});C.val("");var P=e(t).data("settings").prePopulate||C.data("pre");function I(n){return e(t).data("settings").enableHTML?n:m(n)}function M(n){e(t).data("settings").disabled="boolean"==typeof n?n:!e(t).data("settings").disabled,x.attr("disabled",e(t).data("settings").disabled),E.toggleClass(e(t).data("settings").classes.disabled,e(t).data("settings").disabled),S&&L(e(S),r.END),C.attr("disabled",e(t).data("settings").disabled)}function N(){if(null!==e(t).data("settings").tokenLimit&&k>=e(t).data("settings").tokenLimit)return x.hide(),void V()}function $(){var n=e.trim(x.val()).split(e(t).data("settings").tokenDelimiter);e.each(n,function(n,r){if(r){e.isFunction(e(t).data("settings").onFreeTaggingAdd)&&(r=e(t).data("settings").onFreeTaggingAdd.call(C,r));var i={};i[e(t).data("settings").tokenValue]=i[e(t).data("settings").propertyToSearch]=r,B(i)}})}function U(n){var r=e(e(t).data("settings").tokenFormatter(n)),i=!0===n.readonly;i&&r.addClass(e(t).data("settings").classes.tokenReadOnly),r.addClass(e(t).data("settings").classes.token).insertBefore(O),i||e("<span>"+e(t).data("settings").deleteText+"</span>").addClass(e(t).data("settings").classes.tokenDelete).appendTo(r).click(function(){if(!e(t).data("settings").disabled)return D(e(this).parent()),C.change(),!1});var o=n;return e.data(r.get(0),"tokeninput",n),w=w.slice(0,T).concat([o]).concat(w.slice(T)),T++,W(w,C),k+=1,null!==e(t).data("settings").tokenLimit&&k>=e(t).data("settings").tokenLimit&&(x.hide(),V()),r}function B(n){var r=e(t).data("settings").onAdd;if(k>0&&e(t).data("settings").preventDuplicates){var i=null;if(E.children().each(function(){var t=e(this),r=e.data(t.get(0),"tokeninput");if(r&&r.id===n.id)return i=t,!1}),i)return F(i),O.insertAfter(i),void Q(x)}(null==e(t).data("settings").tokenLimit||k<e(t).data("settings").tokenLimit)&&(U(n),N()),x.val(""),V(),e.isFunction(r)&&r.call(C,n)}function F(n){e(t).data("settings").disabled||(n.addClass(e(t).data("settings").classes.selectedToken),S=n.get(0),x.val(""),V())}function L(n,i){n.removeClass(e(t).data("settings").classes.selectedToken),S=null,i===r.BEFORE?(O.insertBefore(n),T--):i===r.AFTER?(O.insertAfter(n),T++):(O.appendTo(E),T=k),Q(x)}function D(n){var r=e.data(n.get(0),"tokeninput"),i=e(t).data("settings").onDelete,o=n.prevAll().length;o>T&&o--,n.remove(),S=null,Q(x),w=w.slice(0,o).concat(w.slice(o+1)),o<T&&T--,W(w,C),k-=1,null!==e(t).data("settings").tokenLimit&&(x.show().val(""),Q(x)),e.isFunction(i)&&i.call(C,r)}function W(n,r){var i=e.map(n,function(n){return"function"==typeof e(t).data("settings").tokenValue?e(t).data("settings").tokenValue.call(this,n):n[e(t).data("settings").tokenValue]});r.val(i.join(e(t).data("settings").tokenDelimiter))}function V(){A.hide().empty(),j=null}function z(){A.css({position:"absolute",top:e(E).offset().top+e(E).outerHeight(),left:e(E).offset().left,width:e(E).width(),"z-index":e(t).data("settings").zindex}).show()}e(t).data("settings").processPrePopulate&&e.isFunction(e(t).data("settings").onResult)&&(P=e(t).data("settings").onResult.call(C,P)),P&&P.length&&e.each(P,function(e,t){U(t),N()}),e(t).data("settings").disabled&&M(!0),e.isFunction(e(t).data("settings").onReady)&&e(t).data("settings").onReady.call(),this.clear=function(){E.children("li").each(function(){0===e(this).children("input").length&&D(e(this))})},this.add=function(e){B(e)},this.remove=function(t){E.children("li").each(function(){if(0===e(this).children("input").length){var n=e(this).data("tokeninput"),r=!0;for(var i in t)if(t[i]!==n[i]){r=!1;break}r&&D(e(this))}})},this.getTokens=function(){return w},this.toggleDisabled=function(e){M(e)};var q=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g");function H(e){return e.replace(q,"\\$&")}function J(e,t,n){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+H(t)+")(?![^<>]*>)(?![^&;]+;)","g"),function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+H(t)+")(?![^<>]*>)(?![^&;]+;)","gi"),function(e,t){return"<b>"+I(t)+"</b>"})}(t,n))}function K(n,r){if(r&&r.length){A.empty();var i=e("<ul>").appendTo(A).mouseover(function(t){G(e(t.target).closest("li"))}).mousedown(function(t){return B(e(t.target).closest("li").data("tokeninput")),C.change(),!1}).hide();e(t).data("settings").resultsLimit&&r.length>e(t).data("settings").resultsLimit&&(r=r.slice(0,e(t).data("settings").resultsLimit)),e.each(r,function(r,o){var s=e(t).data("settings").resultsFormatter(o);s=J(s,o[e(t).data("settings").propertyToSearch],n),s=e(s).appendTo(i),r%2?s.addClass(e(t).data("settings").classes.dropdownItem):s.addClass(e(t).data("settings").classes.dropdownItem2),0===r&&G(s),e.data(s.get(0),"tokeninput",o)}),z(),e(t).data("settings").animateDropdown?i.slideDown("fast"):i.show()}else e(t).data("settings").noResultsText&&(A.html("<p>"+I(e(t).data("settings").noResultsText)+"</p>"),z())}function G(n){n&&(j&&function(n){n.removeClass(e(t).data("settings").classes.selectedDropdownItem),j=null}(e(j)),n.addClass(e(t).data("settings").classes.selectedDropdownItem),j=n.get(0))}function Y(){var n=x.val();n&&n.length&&(S&&L(e(S),r.AFTER),n.length>=e(t).data("settings").minChars?(e(t).data("settings").searchingText&&(A.html("<p>"+I(e(t).data("settings").searchingText)+"</p>"),z()),clearTimeout(y),y=setTimeout(function(){!function(n){var r=n+X(),i=_.get(r);if(i)e.isFunction(e(t).data("settings").onCachedResult)&&(i=e(t).data("settings").onCachedResult.call(C,i)),K(n,i);else if(e(t).data("settings").url){var o=X(),s={data:{}};if(o.indexOf("?")>-1){var a=o.split("?");s.url=a[0];var u=a[1].split("&");e.each(u,function(e,t){var n=t.split("=");s.data[n[0]]=n[1]})}else s.url=o;s.data[e(t).data("settings").queryParam]=n,s.type=e(t).data("settings").method,s.dataType=e(t).data("settings").contentType,e(t).data("settings").crossDomain&&(s.dataType="jsonp"),s.success=function(i){_.add(r,e(t).data("settings").jsonContainer?i[e(t).data("settings").jsonContainer]:i),e.isFunction(e(t).data("settings").onResult)&&(i=e(t).data("settings").onResult.call(C,i)),x.val()===n&&K(n,e(t).data("settings").jsonContainer?i[e(t).data("settings").jsonContainer]:i)},e.ajax(s)}else if(e(t).data("settings").local_data){var c=e.grep(e(t).data("settings").local_data,function(r){return r[e(t).data("settings").propertyToSearch].toLowerCase().indexOf(n.toLowerCase())>-1});_.add(r,c),e.isFunction(e(t).data("settings").onResult)&&(c=e(t).data("settings").onResult.call(C,c)),K(n,c)}}(n)},e(t).data("settings").searchDelay)):V())}function X(){var n=e(t).data("settings").url;return"function"==typeof e(t).data("settings").url&&(n=e(t).data("settings").url.call(e(t).data("settings"))),n}function Q(e){setTimeout(function(){e.focus()},50)}},e.TokenList.Cache=function(t){var n=e.extend({max_size:500},t),r={},i=0;this.add=function(e,t){i>n.max_size&&(r={},i=0),r[e]||(i+=1),r[e]=t},this.get=function(e){return r[e]}}}(jQuery);var Message,MessageCollection,randomName=function(){var e=["Aqua","Black","Blue","Fuchsia","Gray","Green","Lime","Maroon","Navy","Olive","Orange","Purple","Red","Silver","Teal","White","Yellow"],t=["Aardvark","Albatross","Alligator","Alpaca","Ant","Anteater","Antelope","Ape","Armadillo","Donkey","Baboon","Badger","Barracuda","Bat","Bear","Beaver","Bee","Bison","Boar","Buffalo","Butterfly","Camel","Capybara","Caribou","Cassowary","Cat","Caterpillar","Chamois","Cheetah","Chicken","Chimpanzee","Chinchilla","Chough","Clam","Cobra","Cockroach","Cod","Cormorant","Coyote","Crab","Crane","Crocodile","Crow","Curlew","Deer","Dinosaur","Dog","Dogfish","Dolphin","Dotterel","Dove","Dragonfly","Duck","Dugong","Dunlin","Eagle","Echidna","Eel","Eland","Elephant","Elk","Emu","Falcon","Ferret","Finch","Fish","Flamingo","Fly","Fox","Frog","Gaur","Gazelle","Gerbil","Giraffe","Gnat","Gnu","Goat","Goose","Goldfinch","Goldfish","Gorilla","Goshawk","Grasshopper","Grouse","Guanaco","Gull","Hamster","Hare","Hawk","Hedgehog","Heron","Herring","Hippopotamus","Hornet","Horse","Hummingbird","Hyena","Ibex","Ibis","Jackal","Jaguar","Jay","Jellyfish","Kangaroo","Kingfisher","Koala","Kookabura","Kouprey","Kudu","Lapwing","Lark","Lemur","Leopard","Lion","Llama","Lobster","Locust","Loris","Louse","Lyrebird","Magpie","Mallard","Manatee","Mandrill","Mantis","Marten","Meerkat","Mink","Mole","Mongoose","Monkey","Moose","Mouse","Mosquito","Mule","Narwhal","Newt","Nightingale","Octopus","Okapi","Opossum","Oryx","Ostrich","Otter","Owl","Ox","Oyster","Panther","Parrot","Partridge","Peafowl","Pelican","Penguin","Pheasant","Pig","Pigeon","Porcupine","Porpoise","Quail","Quelea","Quetzal","Rabbit","Raccoon","Rail","Ram","Rat","Raven","Reindeer","Rhinoceros","Rook","Salamander","Salmon","Sandpiper","Sardine","Scorpion","Seahorse","Seal","Shark","Sheep","Shrew","Skunk","Snail","Snake","Sparrow","Spider","Spoonbill","Squid","Squirrel","Starling","Stingray","Stinkbug","Stork","Swallow","Swan","Tapir","Tarsier","Termite","Tiger","Toad","Trout","Turkey","Turtle","Vicuna","Viper","Vulture","Wallaby","Walrus","Wasp","Weasel","Whale","Wolf","Wolverine","Wombat","Woodcock","Woodpecker","Worm","Wren","Yak","Zebra"];return function(){return e[Math.floor(Math.random()*e.length)]+t[Math.floor(Math.random()*t.length)]}}(),User=Backbone.Model.extend({defaults:{name:"",avatar:"",email:"",status:"offline",showPictures:!1,showVideos:!1},idAttribute:"_id",localAttributes:["showPictures","showVideos","showLinkPreviews"],update:function(e){_.each(e,function(e,t){this.idAttribute!==t&&this.set(t,e)},this)},chatInPrivateWaveWithUser:function(e){if(e!==this){var t=app.model.waves.filter(function(t){return 2===t.users.length&&t.users.contains(e)&&t.users.contains(this)},this);t.length?app.navigate("wave/"+t[0].id,{trigger:!0}):Communicator.createWave(randomName()+"Room",[e.id])}},loadLocalAttributes:function(){void 0!==window.localStorage&&_.each(this.localAttributes,function(e){var t=this.id+e;this.set(e,localStorage.getItem(t)>0)},this)},saveLocalAttributes:function(){void 0!==window.localStorage&&_.each(this.localAttributes,function(e){var t=this.id+e;localStorage.setItem(t,this.get(e)?1:0)},this)}}),UserCollection=Backbone.Collection.extend({model:User,getUser:function(e){var t=this.get(e);return void 0===t&&(t=new User({_id:e,name:"[loading]"}),this.add(t),Communicator.getUser(e)),t}}),Wave=Backbone.Model.extend({defaults:{title:"",userIds:[],current:!1,archived:!0},idAttribute:"_id",initialize:function(){if(this.messages=new MessageCollection,this.users=new UserCollection,this.get("userIds")){var e=this.get("userIds");this.addUsers(e)}},addMessage:function(e){if(null!==e.get("parentId")){var t,n,r=this.messages.get(e.get("parentId"));if(!r)return this.messages.length>0&&(t=e.get("parentId"),n=this.messages.at(0).id,Communicator.getMessages(this,t,n)),!1;r.addReply(e),this.messages.add(e)}else this.messages.add(e);return Date.now()-e.get("created_at_date").getTime()<6048e5&&this.set("archived",!1),!0},addUser:function(e){this.users.add(e)},addUsers:function(e){_.each(e,function(e){var t=app.model.users.get(e);this.addUser(t)},this)},getUnreadCount:function(){return this.messages.reduce(function(e,t){return e+(t.get("unread")?1:0)},0)},getUserNames:function(){return this.users.pluck("name").join(", ")},getUserCount:function(){return this.users.length},update:function(e){this.set("title",e.title);var t,n,r=this.get("userIds");e.userIds!==r&&(n=_.difference(e.userIds,r),t=_.difference(r,e.userIds),this.users.remove(t),this.addUsers(n),this.set("userIds",e.userIds))},setCurrentMessage:function(e){this.currentMessageId=e},getNextUnreadMessage:function(){var e,t,n,r,i=0;if(this.currentMessageId){if(r=this.messages.get(this.currentMessageId),i=r.getSortableId(),e=r.getNextUnread(i,!1,[]))return e;i=r.getRootId()}for(t=this.messages.filter(function(e){return e.getSortableId()>i&&null===e.get("parentId")}),n=0;n<t.length;n++)if(e=t[n].getNextUnread(i,!0,[]))return e;if(i>0)for(t=this.messages.filter(function(e){return e.getSortableId()<i&&null===e.get("parentId")}),n=0;n<t.length;n++)if(e=t[n].getNextUnread(0,!0,[]))return e;return e||this.trigger("noMoreUnread"),e},getPreviousMessages:function(){if(this.messages.length){var e=this.messages.at(0).id;Communicator.getMessages(this,null,e)}},readAllMessages:function(){var e=!1;this.messages.each(function(t){e=t.readAllMessages()||e}),e&&(this.trigger("readAll"),Communicator.readAllMessages(this))},quit:function(){Communicator.quitUser(this.id),app.currentWaveId=null,app.model.waves.remove(this),app.model.messages.remove(app.model.messages.where({waveId:this.id}),{silent:!0}),app.showLastWave()}}),WaveCollection=Backbone.Collection.extend({model:Wave,comparator:function(e){return e.id}});Message=Backbone.Model.extend({defaults:{userId:null,waveId:null,parentId:null,message:"",unread:!0,created_at:null,created_at_date:null},idAttribute:"_id",initialize:function(){this.messages=null,this.linkPreviews=[],this.user=app.model.users.getUser(this.get("userId")),this.formatMessage(),this.set("created_at_date",new Date(this.get("created_at"))),this.isNew()||this.set("unread",this.get("unread")&&app.model.currentUser.id!==this.get("userId"))},addReply:function(e){null===this.messages&&(this.messages=new MessageCollection,this.trigger("messagesCreated")),this.messages.add(e)},read:function(){this.get("unread")&&(this.set("unread",!1),Communicator.readMessage(this))},setCurrent:function(){this.getWave().setCurrentMessage(this.id)},setScrolled:function(){this.trigger("change:scrolled")},formatMessage:function(){var e,t,n,r,i,o,s=this.get("message"),a=/((https?:\/\/|www\.)\S+)/g,u=/\.(jpg|png|gif)(\?.*)?$/gi,c=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]+).*/gim,l=/.*youtu.*/im,h="";for(t=0,n=(e=(s=strip_tags(s=(s=(s=s.replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\n/g," \n"))).split(" ")).length;t<n;t++)(r=e[t].match(a))?(i=o=r[0],o=o.length>53?o.substr(0,50)+"...":o,i="http"===i.substr(0,4)?i:"http://"+i,app.model.currentUser.get("showPictures")&&i.match(u)?h='<br><a href="'+i+'" target="_blank"><img class="message-img" src="'+i+'"></a>':app.model.currentUser.get("showVideos")&&i.match(c)&&i.match(l)?h='<br><iframe width="420" height="315" src="https://youtube.com/embed/'+(i=c.exec(i))[2]+'" frameborder="0" allowfullscreen></iframe>':(h='<a href="'+i+'" target="_blank">'+o+"</a>",app.model.currentUser.get("showLinkPreviews")&&Communicator.getLinkPreview(i,this)),e[t]=e[t].replace(r[0],h)):e[t]=wordwrap(e[t],200," ",!0);s=nl2br(s=e.join(" "),!0),this.set("messageFormatted",s)},getSortableId:function(){if(!this.sortableId)if(24===this.id.toString().length){var e=Number("0x"+this.id.substr(0,8)),t=Number("0x"+this.id.substr(18,6));this.sortableId=e+t%1e3/1e3}else this.sortableId=this.id;return this.sortableId},readAllMessages:function(){var e=this.get("unread");return this.set({unread:!1},{silent:!0}),e},getNextUnread:function(e,t,n){if(_.indexOf(n,this.getSortableId())>-1)return null;if(n.push(this.getSortableId()),this.getSortableId()>e&&this.get("unread"))return this;var r,i=this.messages?this.messages.toArray():[],o=null;for(r=0;r<i.length;r++)if(o=i[r].getNextUnread(e,!0,n))return o;return o||!this.get("parentId")||t?o:app.model.messages.get(this.get("parentId")).getNextUnread(0,!1,n)},getRootId:function(){return this.get("parentId")?app.model.messages.get(this.get("parentId")).getRootId():this.getSortableId()},getWave:function(){return app.model.waves.get(this.get("waveId"))},isCurrentUserMentioned:function(){if(this.get("unread")){var e="@"+app.model.currentUser.get("name");return this.get("message").indexOf(e)>=0}return!1},addLinkPreview:function(e){this.linkPreviews.push(e),this.trigger("linkpreview",e)}}),MessageCollection=Backbone.Collection.extend({model:Message,comparator:function(e){return e.getSortableId()}});var SurfAppModel=Backbone.Model.extend({initialize:function(){this.waves=new WaveCollection,this.users=new UserCollection,this.messages=new MessageCollection,this.currentUser=null,this.ready=!1},initCurrentUser:function(e){this.currentUser=e,this.currentUser.loadLocalAttributes(),this.trigger("initCurrentUser")},setReady:function(){this.ready=!0,this.trigger("ready")}}),UserView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","update","chatInPrivate"),this.listenTo(this.model,"change",this.update)},events:{dblclick:"chatInPrivate"},render:function(){var e=_.template($("#user_view").text());return this.setElement(e(this.model.toJSON())),this.$el.attr("src",this.model.get("avatar")),this},update:function(){return this.$el.removeClass("online offline").addClass(this.model.get("status")),this.$el.attr("title",this.model.get("name")),this.$el.attr("alt",this.model.get("name")),this.$el.attr("src")!==this.model.get("avatar")&&this.$el.attr("src",this.model.get("avatar")),this},chatInPrivate:function(){app.model.currentUser.chatInPrivateWaveWithUser(this.model)}}),WaveListView=Backbone.View.extend({initialize:function(){_.bindAll(this,"setCurrent","countMessages","updateMessages","changeUsers","updateTitle","scrollToNextUnread","removeWave"),this.listenTo(this.model,"change:current",this.setCurrent),this.listenTo(this.model,"change:title",this.updateTitle),this.listenTo(this.model,"remove",this.removeWave),this.listenTo(this.model.messages,"change:unread",this.countMessages),this.listenTo(this.model,"readAll",this.countMessages),this.listenTo(this.model.messages,"add",this.countMessages),this.listenTo(this.model.messages,"add",this.updateMessages),this.listenTo(this.model.users,"add",this.changeUsers),this.listenTo(this.model.users,"remove",this.changeUsers)},events:{click:"scrollToNextUnread"},render:function(){var e=_.extend(this.model.toJSON(),{id:this.model.id}),t=_.template($("#wave_list_view").text());return this.setElement(t(e)),this.changeUsers(),this.countMessages(),this.setCurrent(),this},setCurrent:function(){this.model.get("current")&&($(".waveitem").removeClass("open"),this.$el.addClass("open"))},countMessages:function(){var e=this.model.getUnreadCount();e>0?(this.$el.find(".piros").text("| "+e+" "+__("new messages")),this.$el.addClass("updated")):(this.$el.find(".piros").text(""),this.$el.removeClass("updated"))},updateMessages:function(e){e.get("userId")!==app.model.currentUser.id&&e.get("unread")&&this.$el.addClass("updated")},changeUsers:function(){var e=__("{{ usercount }} participants").replace("{{ usercount }}",this.model.getUserCount());this.$el.find(".usercount").text(e)},updateTitle:function(){this.$el.find("h2").text(this.model.get("title"))},scrollToNextUnread:function(e){if(app.currentWaveId===this.model.id){e.preventDefault();var t=this.model.getNextUnreadMessage();t&&t.setScrolled()}$("body.mobile #wave-list").css("left","-55%")},removeWave:function(e){e.id===this.model.id&&this.$el.remove()}}),WaveView=Backbone.View.extend({initialize:function(){_.bindAll(this,"setCurrent","addMessage","addUser","removeUser","updateTitle","showUpdateWave","scrollToNextUnread","scrollToBottom","readAllMessages","quitWave","removeWave","countOfflineUsers","readAll"),this.userViews=[],this.listenTo(this.model,"change:current",this.setCurrent),this.listenTo(this.model,"change:title",this.updateTitle),this.listenTo(this.model,"noMoreUnread",this.scrollToBottom),this.listenTo(this.model,"remove",this.removeWave),this.listenTo(this.model,"readAll",this.readAll),this.listenTo(this.model,"scrollToNextUnread",this.scrollToNextUnread),this.listenTo(this.model.messages,"add",this.addMessage),this.listenTo(this.model.users,"add",this.addUser),this.listenTo(this.model.users,"remove",this.removeUser),this.listenTo(this.model.users,"change",this.countOfflineUsers)},events:{"click a.editwave":"showUpdateWave","click a.gounread":"scrollToNextUnread","click div.wavetop":"scrollToNextUnread","click a.getprevmessages":"getPreviousMessages","click a.readall":"readAllMessages","click a.quit":"quitWave"},render:function(){var e=_.extend(this.model.toJSON(),{id:this.model.id}),t=new WaveReplyFormView({model:this.model});return this.setElement(waveTemplate(e)),this.$el.hide(),t.render().$el.appendTo(this.$el.find(".waves-container")),this.model.users.each(this.addUser),this.fragmentMode=!0,this.fragment=$(document.createDocumentFragment()),this.model.messages.each(this.addMessage,this),this.fragmentMode=!1,this.$el.find(".messages").append(this.fragment),this},setCurrent:function(){this.model.get("current")&&($(".wave").hide(),this.$el.show(),this.scrollToNextUnread())},addMessage:function(e){if(null===e.get("parentId")){var t,n=new MessageView({model:e}).render().el;this.fragmentMode?this.fragment.append(n):0===(t=this.model.messages.where({parentId:null}).indexOf(e))?this.$el.find("div.getprevmessages").after(n):this.$el.find(".messages > .message").eq(t-1).after(n)}},changeUsers:function(){var e=this.model.getUserNames();this.$el.find("span.usernames").text(e)},addUser:function(e){this.changeUsers();var t=new UserView({model:e});this.userViews[e.id]=t,this.$el.find(".heads").append(t.render().el),this.countOfflineUsers()},removeUser:function(e){this.changeUsers(),this.userViews[e.id].remove(),delete this.userViews[e.id],this.countOfflineUsers()},countOfflineUsers:function(){var e=this.$el.find(".offline-list"),t=this.model.users.where({status:"offline"}).length;t>0?(e.find(".count").text(t),e.show()):e.hide()},updateTitle:function(){this.$el.find("h2").text(this.model.get("title"))},showUpdateWave:function(){return app.view.showUpdateWave()},scrollToNextUnread:function(e){ga("send","event","WaveView","scrollToNextUnread"),e&&e.preventDefault();var t=this.model.getNextUnreadMessage();return t&&t.setScrolled(),!1},scrollToBottom:function(){var e=this.$el.find(".waves-container");e.scrollTop(e.prop("scrollHeight")).focus()},getPreviousMessages:function(e){e.preventDefault(),ga("send","event","WaveView","getPreviousMessages"),this.model.getPreviousMessages()},readAllMessages:function(e){ga("send","event","WaveView","readAllMessages"),e.preventDefault(),this.model.readAllMessages()},quitWave:function(e){ga("send","event","WaveView","quitWave"),e.preventDefault();var t=__("Do you want to leave conversation {{ title }}?\n\nIf you want to come back later, participants can invite you").replace("{{ title }}",this.model.get("title"));confirm(t)&&this.model.quit()},removeWave:function(e){e.id===this.model.id&&this.$el.remove()},readAll:function(){this.$el.find("table.unread").removeClass("unread")}}),MessageView=Backbone.View.extend({initialize:function(){this.model.messages?this.listenTo(this.model.messages,"add",this.addMessage):this.listenTo(this.model,"messagesCreated",function(){this.listenTo(this.model.messages,"add",this.addMessage),this.stopListening(this.model,"messagesCreated")}),this.listenTo(this.model,"change:unread",this.onReadMessage),this.listenTo(this.model,"change:scrolled",this.scrollTo),this.listenTo(this.model.user,"change:name",this.changeUserName),this.listenTo(this.model,"linkpreview",this.addLinkPreview);var e=this.model.get("created_at_date");this.model.set("dateFormatted",this.formatDate(e))},inRender:!1,events:{click:"readMessage",dbltap:"replyMessage","click a.reply":"replyMessage","click a.threadend":"replyMessage"},render:function(){var e=_.extend(this.model.toJSON(),{id:this.model.id,user:this.model.user.toJSON()}),t=new UserView({model:this.model.user}),n=this;return this.setElement(messageTemplate(e)),this.model.get("unread")||this.$el.children("table").removeClass("unread"),this.$el.find(".message-header").html(t.render().el),this.$el.children("div.threadend").hide(),this.model.isCurrentUserMentioned()&&this.mention(),this.model.messages&&(this.inRender=!0,this.model.messages.each(this.addMessage,this),this.inRender=!1),this.model.linkPreviews.forEach(function(e){n.addLinkPreview(e)}),this},addMessage:function(e){var t=new MessageView({model:e});this.$el.children(".replies").append(t.render().el),(this.inRender||1===this.model.messages.length)&&0===this.$el.children("div.replyform").length&&this.$el.children("div.threadend").show()},readMessage:function(e){e.stopPropagation(),this.model.read(),this.model.setCurrent()},onReadMessage:function(){this.model.get("unread")||this.$el.children("table").removeClass("unread")},scrollTo:function(){var e=this.$el.position().top,t=this.$el.parents(".waves-container"),n=t.height();this.$el.triggerHandler("click"),(e<0||e>n)&&t.scrollTop(e+t.scrollTop()-.3*n),this.$el.children("table").focus()},replyMessage:function(e){if("TEXTAREA"!==e.target.nodeName){e.preventDefault();var t,n=this.$el.find("> div:last-child").hasClass("replyform");return this.model.getWave().trigger("hideReplyForm"),n?!1:((t=new MessageReplyFormView({model:this.model})).render(),t.show(this.$el),!1)}},changeUserName:function(){this.$el.find("span.author").eq(0).text(this.model.user.get("name")+":")},mention:function(){if("undefined"!=typeof Notification){var e,t,n=!1,r=this;if("granted"===Notification.permission?n=!0:"denied"!==Notification.permission&&Notification.requestPermission(function(e){"granted"===e&&(n=!0)}),n){t=__("{{ participantName }} mentioned you in {{ waveName }}!").replace("{{ participantName }}",this.model.user.get("name")).replace("{{ waveName }}",this.model.getWave().get("title"));try{(e=new Notification(t,{tag:"mentionNotification",icon:"/images/surf-ico.png"})).onclick=function(){r.model.setScrolled()},e.onshow=function(){setTimeout(e.close.bind(e),5e3)}}catch(e){}}}},addLinkPreview:function(e){var t=$(linkPreviewTemplate(_.extend({title:null,image:null,description:null},e)));e.image||t.find("img").remove(),this.$el.children("table").append(t)},formatDate(e){const t=new Date(e);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]} ${t.getDate()} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`}}),WaveReplyFormView=Backbone.View.extend({initialize:function(){_.bindAll(this,"submitForm","handleKeydown")},events:{"submit form":"submitForm","keydown textarea":"handleKeydown"},render:function(){var e=_.template($("#wavereplyform_view").text());return this.setElement(e()),this},submitForm:function(e){e.preventDefault();var t=this.$el.find("textarea");return t.val().length>0&&Communicator.sendMessage(t.val(),this.getWaveId(),this.getParentId()),t.val(""),!1},handleKeydown:function(e){e.shiftKey||13!==e.keyCode?32===e.keyCode&&" "===$(e.target).val()?(e.preventDefault(),this.scrollToNextUnread()):e.shiftKey||9!==e.keyCode||(e.preventDefault(),this.mentionUser()):(e.preventDefault(),this.$el.find("form").submit()),e.stopPropagation()},scrollToNextUnread:function(){this.model.trigger("scrollToNextUnread")},getWaveId:function(){return this.model.id},getWave:function(){return app.model.waves.get(this.getWaveId())},getParentId:function(){return null},mentionUser:function(){var e,t,n,r,i=0,o=this.$el.find("textarea"),s=o[0].selectionEnd||0,a=o.val().lastIndexOf("@",s);if(a>-1&&s-a<50&&(e=o.val().substring(a+1,s).toLowerCase(),(t=this.getWave().users.filter(function(t){return 0===t.get("name").toLowerCase().indexOf(e)})).length>0)){if(1===t.length)n=t[0].get("name");else{for(n=t[0].get("name").substr(0,e.length),r=function(e){return e.get("name").substr(0,n.length)===n};_.all(t,r);)n=t[0].get("name").substr(0,n.length+1);n=n.substr(0,n.length-1)+"?",i=1}o.val(o.val().substring(0,a+1)+n+o.val().substr(s)),o[0].selectionStart=a+1+n.length-i,o[0].selectionEnd=a+1+n.length}}}),MessageReplyFormView=WaveReplyFormView.extend({events:_.extend({"click a.cancel":"handleCancel"},WaveReplyFormView.prototype.events),initialize:function(){WaveReplyFormView.prototype.initialize.apply(this,arguments),this.timeout=75,_.bindAll(this,"handleCancel","hide"),this.listenTo(this.model.getWave(),"hideReplyForm",this.hide)},render:function(){var e=_.template($("#messagereplyform_view").text());return this.setElement(e({user:this.model.user.toJSON()})),this},handleCancel:function(e){return e.preventDefault(),this.hide(),!1},scrollToNextUnread:function(){this.model.getWave().trigger("scrollToNextUnread")},getWaveId:function(){return this.model.get("waveId")},getParentId:function(){return this.model.id},show:function(e){var t=e.children("div.threadend");t.is(":visible")?(t.hide(),this.$el.height(t.height()).appendTo(e).animate({height:"100%"},this.timeout,function(){$(this).find("textarea").focus()})):this.$el.hide().appendTo(e).slideDown(this.timeout,function(){$(this).find("textarea").focus()})},hide:function(){var e,t=this;this.$el.siblings(".replies").children().length>0?(e=this.$el.siblings(".threadend"),this.$el.animate({height:e.height()},this.timeout,function(){e.show(),t.remove()})):this.$el.slideUp(this.timeout,function(){t.remove()})}}),EditWaveView=Backbone.View.extend({initialize:function(){_.bindAll(this,"show","hide","setWave","genUserArray","inviteCodeReady"),this.userArray=[],this.listenTo(this.model.users,"add",this.genUserArray),this.listenTo(this.model.users,"change",this.genUserArray)},events:{"click a.close":"hide","submit form":"editWave","click button#editwave-invite":"getInviteCode"},render:function(){var e=_.template($("#editwave_view").text());return this.setElement(e()),this.$el.hide(),this},genUserArray:function(){this.userArray=this.model.users.reduce(function(e,t){var n={id:t.id,name:t.get("name")+" ("+t.get("email")+")"};return(!this.wave||this.wave&&!this.wave.users.get(t.id))&&e.push(n),e},[],this)},initUserSuggest:function(){this.genUserArray(),this.inited||(this.$el.find("#editwave-users").tokenInput([],{theme:"facebook",preventDuplicates:!0,hintText:__("Enter username."),noResultsText:__("User not found."),searchingText:__("Searching...")}),this.inited=!0)},updateUserSuggest:function(){this.initUserSuggest(),$("#editwave-users").data("settings").local_data=this.userArray;var e=this.$el.find("#editwave-users");e.tokenInput("clear"),this.wave?this.wave.users.each(function(t){e.tokenInput("add",{id:t.id,name:t.get("name"),readonly:!0})}):e.tokenInput("add",{id:app.model.currentUser.id,name:app.model.currentUser.get("name"),readonly:!0})},show:function(){return ga("send","event","EditWaveView","show"),this.$el.find("#editwave-invitecode-block").hide(),this.wave?(this.$el.find("input[name=title]").val(this.wave.get("title")),this.$el.find("h2").text(__("Edit conversation")),this.$el.find("#editwave-submit").text(__("Save")),this.$el.find("#editwave-invite").show()):(this.$el.find("input[name=title]").val(""),this.$el.find("h2").text(__("Add conversation")),this.$el.find("#editwave-submit").text(__("Create")),this.$el.find("#editwave-invite").hide()),this.updateUserSuggest(),this.$el.show(),$("#darken").show(),this.$el.find("#editwave-title").focus(),!1},hide:function(){return this.$el.hide(),$("#darken").hide(),!1},setWave:function(e){this.wave=this.model.waves.get(e),this.wave&&this.listenTo(this.wave,"inviteCodeReady",this.inviteCodeReady)},editWave:function(){var e=this.$el.find("#editwave-title").val(),t=this.$el.find("#editwave-users").tokenInput("get"),n=_.pluck(t,"id");return this.wave?Communicator.updateWave(this.wave.id,e,n):Communicator.createWave(e,n),this.hide()},getInviteCode:function(e){ga("send","event","EditWaveView","getInviteCode"),e.preventDefault(),this.$el.find("button#editwave-invite").hide(),Communicator.getInviteCode(this.wave.id)},inviteCodeReady:function(e){this.$el.find("#editwave-invitecode-block").show();var t=document.location.protocol+"//"+document.location.host+"/invite/"+e;this.$el.find("#editwave-invitecode").val(t).focus().select()}}),EditUserView=Backbone.View.extend({initialize:function(){_.bindAll(this,"show","hide","testNotification"),this.listenTo(this.model,"change",this.updateFields)},events:{"click a.close":"hide","submit form":"saveUser","click button#edituser-notification-test":"testNotification"},render:function(){var e=_.template($("#edituser_view").text());return this.setElement(e()),this.$el.hide(),this.updateFields(),this},updateFields:function(){this.$el.find("#edituser-name").val(this.model.get("name")),this.$el.find("#edituser-avatar").val(this.model.get("avatar")),this.$el.find("input#edituser-show-pictures").attr("checked",this.model.get("showPictures")),this.$el.find("input#edituser-show-videos").attr("checked",this.model.get("showVideos")),this.$el.find("input#edituser-show-linkpreviews").attr("checked",this.model.get("showLinkPreviews")),this.$el.find("div.avatar").remove();var e="https://secure.gravatar.com/avatar/"+this.model.get("emailMD5")+"?s=80&d=monsterid";this.model.get("googleAvatar")&&this.addAvatarOption(this.model.get("googleAvatar")),this.model.get("facebookAvatar")&&this.addAvatarOption(this.model.get("facebookAvatar")),this.addAvatarOption(e)},addAvatarOption:function(e){var t=$(_.template($("#edituser_avatar_view").text())({url:e}));t.find("img").prop("src",e),e===this.model.get("avatar")&&t.find("input").prop("checked",!0),this.$el.find(".ediutuser-avatar-row .right").append(t)},show:function(){return this.$el.show(),$("#darken").show(),this.checkNotification(),!1},hide:function(){return this.$el.hide(),$("#darken").hide(),!1},saveUser:function(e){e.preventDefault();var t=this.$el.find("#edituser-name").val(),n=this.$el.find("input[name=edituser-avatar-cb]:checked").val();return this.model.set("showPictures",this.$el.find("input#edituser-show-pictures").is(":checked"),{silent:!0}),this.model.set("showVideos",this.$el.find("input#edituser-show-videos").is(":checked"),{silent:!0}),this.model.set("showLinkPreviews",this.$el.find("input#edituser-show-linkpreviews").is(":checked"),{silent:!0}),this.model.saveLocalAttributes(),Communicator.updateUser(t,n),this.hide()},checkNotification:function(){window.Notification||(this.$el.find("#edituser-notification-status").text(__("Not supported")),this.$el.find("#edituser-notification-test").hide()),"granted"===Notification.permission?this.$el.find("#edituser-notification-status").text(__("Enabled")):this.$el.find("#edituser-notification-status").text(__("Disabled"))},testNotification:function(){var e=this;Notification.requestPermission(function(t){if("granted"===t){var n=new Notification("Test notification",{tag:"mentionNotification",icon:"/images/surf-ico.png"});n.onshow=function(){setTimeout(n.close.bind(n),5e3)},e.checkNotification()}})}}),DisconnectedView=Backbone.View.extend({initialize:function(){_.bindAll(this,"show"),this.counterStart=3,this.counter=this.counterStart},render:function(){var e=_.template($("#disconnected_view").text());return this.setElement(e({counter:this.counter})),this.$el.hide(),this},show:function(){if(ga("send","event","DisconnectedView","show","connection",this.model.reconnect?1:0),this.model.reconnect){var e=this;this.interval=setInterval(function(){e.count()},1e3)}else this.$el.find(".countdown").hide();return this.$el.show(),$("#darken").show(),!1},count:function(){if(this.counter--,this.counter>0)this.$el.find(".counter").text(this.counter);else{var e=this;clearInterval(e.interval),$.ajax("images/surf-ico.png?"+Math.random(),{timeout:900}).fail(function(){e.counterStart*=2,e.counter=e.counterStart,e.interval=setInterval(function(){e.count()},1e3)}).done(function(){document.location.href="/"})}}}),SurfAppView=Backbone.View.extend({initialize:function(){_.bindAll(this,"addMessage","showCreateWave","showUpdateWave","showEditUser","hideOverlays","addWave"),this.listenTo(this.model.waves,"add",this.addWave),this.listenTo(this.model.waves,"reset",this.resetWaves),this.listenTo(this.model.waves,"reset",this.handleEmpty),this.listenTo(this.model.waves,"remove",this.handleEmpty),this.listenTo(this.model.messages,"reset",this.resetMessages),this.listenTo(this.model.messages,"add",this.setTitle),this.listenTo(this.model.messages,"change:unread",this.setTitle),this.listenTo(this.model.waves,"readAll",this.setTitle),this.listenTo(this.model.waves,"change:current",this.renderWave),this.listenTo(this.model,"initCurrentUser",this.initCurrentUser),this.listenTo(this.model,"ready",this.handleReady),this.renderedWaves=[],this.waveListViews=[],this.render()},events:{"click a.addwave":"showCreateWave","click a.edituser":"showEditUser","click #darken":"hideOverlays"},render:function(){this.setElement($("body")),this.editWaveView=new EditWaveView({model:this.model}),this.$el.append(this.editWaveView.render().el),this.iconImage=new Image;var e=this;return this.iconImage.onload=function(){e.setTitle()},this.iconImage.src="images/surf-ico.png",$(".empty").hide(),$("body").keydown(function(e){var t=$(e.target).prop("nodeName");"INPUT"!==t&&"TEXTAREA"!==t&&32===e.keyCode&&(e.preventDefault(),app.currentWaveId&&(document.activeElement.blur(),app.model.waves.get(app.currentWaveId).trigger("scrollToNextUnread")))}),$(window).resize(function(){$(window).width()<1e3?($("body").addClass("mobile"),$("body.mobile").on("swiperight",function(){$("body.mobile #wave-list").css("left",0)}),$("body.mobile").on("swipeleft",function(){$("body.mobile #wave-list").css("left","-55%")}),$("body.mobile #header-logo").on("click",function(){return 0===parseInt($("#wave-list").css("left"))?$("body.mobile #wave-list").css("left","-55%"):$("body.mobile #wave-list").css("left",0),!1})):$("body").removeClass("mobile")}).trigger("resize"),this},addWave:function(e){var t=new WaveListView({model:e});this.handleEmpty(),(e.get("archived")?$("#wave-list-archived"):$("#wave-list-active")).append(t.render().el),this.waveListViews.push(t)},resetWaves:function(){this.model.waves.map(this.addWave,this)},renderWave:function(e){if(!_.contains(this.renderedWaves,e)){var t=new WaveView({model:e});$("#wave-container").append(t.render().el),t.setCurrent(),this.renderedWaves.push(e)}},addMessage:function(e){var t=this.model.waves.get(e.get("waveId"));t&&t.addMessage(e)},resetMessages:function(){this.model.messages.map(this.addMessage),this.setTitle()},showCreateWave:function(){return this.editWaveView.setWave(null),this.editWaveView.show(),!1},showUpdateWave:function(){return this.editWaveView.setWave(app.model.waves.get(app.currentWaveId)),this.editWaveView.show(),!1},showEditUser:function(){return this.editUserView&&this.editUserView.show(),!1},showDisconnected:function(e){this.disconnectedView=new DisconnectedView({model:{reconnect:e}}),this.$el.append(this.disconnectedView.render().el),this.disconnectedView.show()},hideOverlays:function(){return _.isUndefined(this.disconnectedView)&&($("#darken").hide(),$(".overlay").hide()),!1},initCurrentUser:function(){var e=new UserView({model:this.model.currentUser});return this.$el.find("#currentuser").html("").append(e.render().el).append(' <p class="currentuser_name">'+this.model.currentUser.escape("name")+"</p>"),this.listenTo(this.model.currentUser,"change:name",this.changeCurrentUserName),this.editUserView=new EditUserView({model:this.model.currentUser}),this.$el.append(this.editUserView.render().el),!1},changeCurrentUserName:function(){return this.$el.find("p.currentuser_name").text(this.model.currentUser.escape("name")),!1},setTitle:function(){if(this.model.ready){var e="SURF",t=this.model.messages.where({unread:!0}).length;t>0&&(e="["+t+"] "+e),$("title").text(e),this.setIcon(t)}},setIcon:function(e){if(this.iconImage.complete)try{var t,n,r,i=document.createElement("canvas");i.width=35,i.height=35,(t=i.getContext("2d")).drawImage(this.iconImage,0,0),e>0&&(n=e>99?"99+":e.toString(),t.fillStyle="#ffffff",t.globalAlpha=.7,t.fillRect(34-9*n.length,21,9*n.length+1,14),t.globalAlpha=1,t.fillStyle="#847099",t.font="bold 16px sans-serif",t.fillText(n,35-9*n.length,35)),(r=document.createElement("link")).type="image/x-icon",r.rel="shortcut icon",r.href=i.toDataURL("image/x-icon"),$('link[rel="shortcut icon"]').remove(),$("head").append(r)}catch(e){return e}},handleEmpty:function(){0===app.model.waves.length?$(".empty").show():$(".empty").hide()},handleReady:function(){this.handleArchiveChange(),this.setTitle(),this.listenTo(this.model.waves,"change:archived",this.handleArchiveChange),this.listenTo(this.model.waves,"add",this.handleArchiveChange)},handleArchiveChange:function(){this.waveListViews.forEach(function(e){e.remove()}),this.waveListViews=[],this.model.waves.forEach(this.addWave,this),0===this.model.waves.filter({archived:!1}).length?$("#wave-list-active").hide():$("#wave-list-active").show(),0===this.model.waves.filter({archived:!0}).length?$("#wave-list-archived").hide():$("#wave-list-archived").show()}}),Communicator={socket:null,reconnect:!0,createTitle:null,readQueue:[],queueReads:!1,initialize:function(){if(void 0!==window.io){var e=this;this.socket=io({reconnection:!1}),this.socket.on("init",function(t){e.onInit(t)}),this.socket.on("message",function(t){e.onMessage(t)}),this.socket.on("disconnect",function(){app.view.showDisconnected(e.reconnect)}),this.socket.on("updateUser",this.onUpdateUser),this.socket.on("updateWave",function(t){e.onUpdateWave(t)}),this.socket.on("inviteCodeReady",this.onInviteCodeReady),this.socket.on("linkPreviewReady",this.onLinkPreviewReady),this.socket.on("dontReconnect",function(){e.reconnect=!1}),this.socket.on("ready",function(){e.queueReads=app.model.messages.where({unread:!0}).length>1,app.showLastWave(),app.model.setReady()})}else console.error("no io")},onInit:function(e){null===app.model.currentUser&&(e.users.push(e.me),app.model.users.reset(e.users),app.model.initCurrentUser(app.model.users.get(e.me._id)),app.model.waves.reset(e.waves))},sendMessage:function(e,t,n){var r={userId:app.model.currentUser.id,waveId:t,message:e,parentId:n};this.socket.emit("message",r)},readMessage:function(e){this.queueReads?(this.readQueue.push(e),this.queueReads=!1):(this.readQueue.forEach(function(e){this.socket.emit("readMessage",{id:e.id,waveId:e.get("waveId")})},this),this.readQueue=[],this.socket.emit("readMessage",{id:e.id,waveId:e.get("waveId")}))},readAllMessages:function(e){this.socket.emit("readAllMessages",{waveId:e.id})},createWave:function(e,t){var n={title:e,userIds:t};this.createTitle=e,this.socket.emit("createWave",n)},updateWave:function(e,t,n){var r={id:e,title:t,userIds:n};this.socket.emit("updateWave",r)},onMessage:function(e){if(e.messages)_.each(e.messages,function(e){this.onMessage(e)},this);else{var t=new Message(e);app.model.waves.get(e.waveId).addMessage(t)&&app.model.messages.add(t)}},onUpdateUser:function(e){var t=e.user;app.model.users.get(t._id)?app.model.users.get(t._id).update(t):app.model.users.add(new User(t))},onUpdateWave:function(e){var t,n=e.wave;app.model.waves.get(n._id)?app.model.waves.get(n._id).update(n):(t=new Wave(n),app.model.waves.add(t),1!==app.model.waves.length&&this.createTitle!==t.get("title")||app.navigate("wave/"+t.id,{trigger:!0}))},getMessages:function(e,t,n){var r={waveId:e.id,minParentId:t,maxRootId:n};this.socket.emit("getMessages",r)},getUser:function(e){var t={userId:e};this.socket.emit("getUser",t)},quitUser:function(e){var t={waveId:e};this.socket.emit("quitWave",t)},getInviteCode:function(e){var t={waveId:e};this.socket.emit("createInviteCode",t)},onInviteCodeReady:function(e){app.model.waves.get(e.waveId)&&app.model.waves.get(e.waveId).trigger("inviteCodeReady",e.code)},updateUser:function(e,t){var n={name:e,avatar:t};this.socket.emit("updateUser",n)},getLinkPreview:function(e,t){this.socket.emit("getLinkPreview",{msgId:t.id,url:e})},onLinkPreviewReady:function(e){app.model.messages.get(e.msgId)&&app.model.messages.get(e.msgId).addLinkPreview(e.data)}},SurfAppRouter=Backbone.Router.extend({defaults:{currentWaveId:null},initialize:function(){this.model=new SurfAppModel,this.view=new SurfAppView({model:this.model})},routes:{"wave/:number":"showWave"},showWave:function(e){this.model.waves.get(e)?(this.currentWaveId&&this.model.waves.get(this.currentWaveId).set("current",!1),this.model.waves.get(e).set("current",!0),this.currentWaveId=e):this.model.waves.length?this.showLastWave():this.navigate("/")},showLastWave:function(){var e,t;(e=this.model.messages.last())?this.navigate("wave/"+e.get("waveId"),{trigger:!0}):(t=this.model.waves.last(),this.showWave(t?t.id:null))}});window.onerror=function(e,t,n){var r={prefix:"JSERROR",errorMessage:e+" in "+t+" on line "+n+". URL: "+window.location.href+" BROWSER: "+navigator.userAgent};$.post("/logError",r)},$(function(){_.templateSettings={interpolate:/{|\|([\s\S]+?)\|}/g,escape:/{{([\s\S]+?)}}/g};var e=new SurfAppRouter;window.app=e,window.messageTemplate=_.template($("#message_view").text()),window.linkPreviewTemplate=_.template($("#message_linkpreview_view").text()),window.waveTemplate=_.template($("#wave_view").text()),Backbone.history.start(),Communicator.initialize()});